!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r(require("@progress/kendo-data-query"),require("tslib")):"function"==typeof define&&define.amd?define([,],r):"object"==typeof exports?exports.KendoPivotgridCommon=r(require("@progress/kendo-data-query"),require("tslib")):e.KendoPivotgridCommon=r(e.KendoDataQuery,e.self)}(self,((e,r)=>(()=>{"use strict";var t={75:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.createDataState=void 0;var n=t(70);r.createDataState=function(e){return{columns:(0,n.reverseColumnsByMeasures)(e.columns.tuples),data:e.data,rows:e.rows.tuples}}},644:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.createAxisDescriptors=function(e){for(var r=[],t=0,n=Object.keys(e);t<n.length;t++){var a=n[t];r.push({name:JSON.parse(a),expand:e[a]})}return r}},658:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.setFilter=void 0,r.setFilter=function(e,r){void 0===r&&(r=[]),e.filter=r}},220:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.setSort=void 0,r.setSort=function(e,r){void 0===r&&(r=[]),e.sort=r}},191:(e,r)=>{var t;Object.defineProperty(r,"__esModule",{value:!0}),r.averageAggregate=r.maxAggregate=r.minAggregate=r.countAggregate=r.sumAggregate=r.createAggregate=r.AggregateType=void 0,function(e){e[e.Sum=0]="Sum",e[e.Count=1]="Count",e[e.Min=2]="Min",e[e.Max=3]="Max",e[e.Average=4]="Average"}(t||(r.AggregateType=t={}));var n=0;r.createAggregate=function(e){var r="".concat(t[e],"_").concat(n++);switch(e){case t.Sum:return{init:function(e){r in e==0&&(e[r]=0)},merge:function(e,t){t[r]+=e[r]},accumulate:function(e,t){e[r]+=t},result:function(e){return e[r]},format:function(e){return e.toFixed(2)}};case t.Count:return{init:function(e){r in e==0&&(e[r]=0)},merge:function(e,t){t[r]+=e[r]},accumulate:function(e,t){e[r]+=1},result:function(e){return e[r]},format:function(e){return e.toFixed()}};case t.Min:return{init:function(e){r in e==0&&(e[r]=Number.POSITIVE_INFINITY)},merge:function(e,t){t[r]=Math.min(e[r],t[r])},accumulate:function(e,t){e[r]=Math.min(t,e[r])},result:function(e){return Number.isFinite(e[r])?e[r]:NaN},format:function(e){return e.toFixed(2)}};case t.Max:return{init:function(e){r in e==0&&(e[r]=Number.NEGATIVE_INFINITY)},merge:function(e,t){t[r]=Math.max(e[r],t[r])},accumulate:function(e,t){e[r]=Math.max(t,e[r])},result:function(e){return Number.isFinite(e[r])?e[r]:NaN},format:function(e){return e.toFixed(2)}};case t.Average:var a="".concat(r,"_sum"),o="".concat(r,"_count");return{init:function(e){o in e==0&&(e[a]=0,e[o]=0)},merge:function(e,r){r[a]+=e[a],r[o]+=e[o]},accumulate:function(e,r){e[a]+=r,e[o]+=1},result:function(e){return e[a]/e[o]},format:function(e){return e.toFixed(2)}};default:throw new Error("Invalid aggregate type provided")}},r.sumAggregate=(0,r.createAggregate)(t.Sum),r.countAggregate=(0,r.createAggregate)(t.Count),r.minAggregate=(0,r.createAggregate)(t.Min),r.maxAggregate=(0,r.createAggregate)(t.Max),r.averageAggregate=(0,r.createAggregate)(t.Average)},908:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.readData=void 0;var n=t(111),a=t(238),o=function(e,r,t){var n=(0,a.splitKeyValue)(e),o=n[0],i=n[1],u=t.slice();if(o&&i){var s=r.find((function(e){return e.key===o})),l=s?s.caption:"";return u.map((function(r){return r===l?e:r}))}return u},i=function(e,r,t,i,u,s,l){for(var c=l||new Map,f=i.map((function(e){return e.caption}));r.length>1&&i.some((function(e){return e.caption===r[r.length-1].caption}));)r.pop(),f.pop();var p=e;return r.forEach((function(e,r){if(f=o(e.name,i,f),p&&!i.some((function(r){return r.caption===e.name}))){if(!p.has(e.name)&&!c.has(f.slice(0,f.indexOf(e.name)+1).join("-")))for(var l=Array.from(p).find((function(e){return e[0]!==t})),d=l&&l[0],m=d&&(0,a.splitKeyValue)(d)[0],g=m?r-i.findIndex((function(e){return e.key===m})):0,v=function(r){var a=[];p.forEach((function(e,r){r!==t&&a.push.apply(a,Array.from(e).filter((function(e){return e[0]!==t})))}));var l=new Map;a.forEach((function(e){if(l.has(e[0])){var r=l.get(e[0]),t=e[1],a=new Map;(0,n.mergeTrees)(r,a,u,s),(0,n.mergeTrees)(t,a,u,s),l.set(e[0],a)}else l.set(e[0],new Map(e[1]))}));var d=f.slice(0,f.indexOf(e.name));l.forEach((function(e,r){c.set(o(r,i,d.concat([r])).join("-"),e)})),l.set(t,p.get(t)),p=l},h=0;h<g;h++)v();p=p.get(e.name)||c.get(f.slice(0,f.indexOf(e.name)+1).join("-"))}})),p};r.readData=function(e,r,t,n,a,o,u){var s=[],l=n.dataField,c=n.columnsData,f=new Map;return r.forEach((function(r){var n=i(e,r.members.slice(),c,o,u,l,f),p=n&&n.get(c);t.forEach((function(e){var t=e.members.slice(),n=u[0];if("[Measures].[MeasuresLevel]"===t[t.length-1].levelName){var o=t.pop();n=u.find((function(e){return String(e.name)===o.caption}))||n}var c=p&&i(p,t,l,a,u,l),f="",d="";if(c&&n){var m=n.aggregate.result(c.get(l));f=String(m),d=n.aggregate.format(m)}s.push({columnTuple:e,data:{fmtValue:d,ordinal:0,value:f},rowTuple:r})}))})),s}},111:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.cloneDataTree=r.createDataTree=r.mergeTrees=void 0;var n=t(429),a=t(238),o=function(e,r,t){e.forEach((function(n,i){if(i!==t){n.size>0&&o(n,r,t);var u=n.get(t),s=(0,a.subNode)(e,t,{});r.forEach((function(e){e.aggregate.init(s),e.aggregate.merge(u,s)}))}}))};r.mergeTrees=function(e,t,n,o){e.forEach((function(e,i){var u;i!==o?(u=(0,a.subNode)(t,i),(0,r.mergeTrees)(e,u,n,o)):(u=(0,a.subNode)(t,i,{}),n.forEach((function(r){r.aggregate.init(u),r.aggregate.merge(e,u)})))}))};var i=function(e,t,n,o){e.forEach((function(u,s){if(s!==n){u.size>0&&i(u,t,n,o);var l=(0,a.subNode)(u,n),c=(0,a.subNode)(e,n);(0,r.mergeTrees)(l,c,t,o)}}))};r.createDataTree=function(e,r,t,u,s,l){var c=new Map,f=new Map,p=r.concat(t),d=new Set,m=s.dataField,g=s.columnsData,v=(0,n.initializeFiltering)(r,t,l),h=v.hasFilter,y=v.predicate,A=v.filteringAxes;return e.forEach((function(e){if(h){var n={};if(A.forEach((function(r){n[r.key]=r.displayValue(e)})),!y(n))return}var o=p.map((function(r){return r.displayValue(e)})),i="".concat.apply("",o),s=f.get(i);if(!s){var l=c,v=function(r){l=(0,a.subNode)(l,(0,a.createKey)(r.key,r.displayValue(e)))};r.forEach(v),l=(0,a.subNode)(l,g),d.add(l),t.forEach(v),s={},l.set(m,s),f.set(i,s),u.forEach((function(e){e.aggregate.init(s)}))}u.forEach((function(r){r.aggregate.accumulate(s,r.value(e))}))})),d.forEach((function(e){return o(e,u,m)})),i(c,u,g,m),c},r.cloneDataTree=function(e,t,n){var a=new Map;return(0,r.mergeTrees)(e,a,n,t),a}},429:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.initializeFiltering=void 0;var n=t(161);function a(e,r){"filters"in e?e.filters.map((function(e){return a(e,r)})):r(e)}var o=function(e,r){(Array.isArray(e)?e:e.filters).forEach((function(e){return a(e,r)}))};r.initializeFiltering=function(e,r,t){var a=t?Array.isArray(t)?{logic:"and",filters:t}:t:void 0,i=a?(0,n.compileFilter)(a):function(){return!0},u=e.concat(r),s=[];o(t||[],(function(e){"field"in e&&e.field&&s.push(e.field)}));var l={hasFilter:!1,predicate:i,filteringAxes:[]};if(s.some((function(e){return"function"==typeof e})))l.filteringAxes=u.slice();else if(s.length>0){var c=Array.from(new Set(s).values()),f=u.filter((function(e){return c.indexOf(e.key)>=0}));l.filteringAxes=f}return l.hasFilter=l.filteringAxes.length>0,l}},167:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0});var n=t(426);n.__exportStar(t(191),r),n.__exportStar(t(111),r),n.__exportStar(t(908),r),n.__exportStar(t(124),r),n.__exportStar(t(673),r),n.__exportStar(t(143),r)},143:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0})},673:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.createFlatSchemaDimensions=void 0,r.createFlatSchemaDimensions=function(e,r){var t=Object.keys(e).map((function(e){return{caption:e,defaultHierarchy:e,description:"",name:e,uniqueName:e,hierarchyUniqueName:e,measure:!0,type:1}}));return r.length&&t.push({caption:"Measures",children:r.map((function(e){return{aggregator:"1",caption:String(e.name),defaultFormat:"",description:"",displayFolder:"",groupName:String(e.name),name:String(e.name),uniqueName:String(e.name)}})),type:2,description:"",name:"Measures",uniqueName:"[Measures]"}),t}},124:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.createLocalDataState=r.addMultipleMeasures=r.createTuples=r.rootFields=void 0;var n=t(70),a=t(238),o=t(908),i=function(e,r,t){e.forEach((function(e,n){if(!t[n]){var o=(0,a.subNode)(r,n);i(e,o,t)}}))};r.rootFields=function(e){var r=new Set;return e.forEach((function(e){1!==e.name.length||(0,a.splitKeyValue)(e.name[0])[1]||r.add(e.name[0])})),r},r.createTuples=function(e,t,n,o,u){var s=(0,r.rootFields)(t),l=[],c=function(e,r){var t={members:[]};return e.forEach((function(e){var n=r.find((function(r){return r.key===e})),a=n?n.caption:"",o={caption:a,children:[],hasChildren:!0,parentName:"",levelNum:0,levelName:a,hierarchy:e,name:a};t.members.push(o)})),t}(s,e);l.push(c);for(var f=function(r){var c=t[r];if(1===c.name.length&&!c.expand&&s.has(c.name[0]))return"continue";var f,p=new Set(s.keys()),d=[],m=[],g=[];c.name.forEach((function(r,t){var s,v=(0,a.splitKeyValue)(r),h=v[0],y=v[1];if(f=e.find((function(e){return e.key===h})),y){p.delete(h),m.push(r);var A={children:[],caption:y,hierarchy:h,levelNum:1,levelName:h+" "+h,name:r,parentName:f?f.caption:""};d.push(A)}else if(c.expand&&c.name.length-1===t){p.delete(r),m.push(r);var _=function(e,r,t){for(var n,o=[],u=function(e){return Array.from(e).filter((function(e){return!t[e[0]]}))},s=new Map(e),l=function(e){if(n=s.get(r[e]))s=new Map(n);else if(e<r.length-1&&Array.from(s).some((function(t){return(0,a.splitKeyValue)(t[0])[0]===r[e]}))){var l=[];s.forEach((function(e,r){t[r]||l.push.apply(l,u(new Map(e)))})),s=new Map,l.forEach((function(e){if(s.has(e[0])){var r=s.get(e[0]),n=e[1],a=new Map;i(r,a,t),i(n,a,t),s.set(e[0],a)}else s.set(e[0],new Map(e[1]))}))}else 0!==e&&e!==r.length-1||Array.from(s).some((function(t){return(0,a.splitKeyValue)(t[0])[0]===r[e]}))&&o.push.apply(o,u(s))},c=0;c<r.length;c++)l(c);return o}(n,m,u),E=o.find((function(e){return e.field===h}));E&&E.dir&&_.sort(function(e,r){return function(t,n){var o=e.dir,i=r.sortValue((0,a.splitKeyValue)(t[0])[1]),u=r.sortValue((0,a.splitKeyValue)(n[0])[1]);return i<u?"asc"===o?-1:1:i>u?"asc"===o?1:-1:0}}(E,f));for(var N=0;N<_.length;N++){var O=_[N][0],x={members:[]};g.push(x);var I=(0,a.splitKeyValue)(O)[1];f=e.find((function(e){return e.key===r})),A={caption:I,children:[],levelName:r+" "+r,levelNum:1,parentName:f?f.caption:"",hierarchy:r,name:O},(s=x.members).push.apply(s,d),x.members.push(A)}}else if(c.expand){var P=(f=e.find((function(e){return e.key===r})))?f.caption:"";p.delete(r),m.push(r),A={children:[],caption:P,hierarchy:r,levelName:P,levelNum:0,name:P,parentName:""},d.push(A)}p.forEach((function(r){g.forEach((function(t){var n=(f=e.find((function(e){return e.key===r})))?f.caption:"",a={children:[],hasChildren:!0,caption:n,hierarchy:r,levelName:n,levelNum:0,name:n,parentName:""};t.members.push(a)}))})),l.push.apply(l,g)}))},p=0;p<t.length;p++)f(p);return l};var u=function(e){return{caption:String(e.name),children:[],hasChildren:!1,hierarchy:"[Measures]",levelName:"[Measures].[MeasuresLevel]",levelNum:0,name:"[Measures].["+e.name+"]",parentName:""}},s=function(e,r){var t=u(r),a=(0,n.copy)(e);return a.members.push(t),a};r.addMultipleMeasures=function(e,r){if(r.length<2)return e;for(var t=e.slice(),a=t.length-1;a>=0;a--){var o=t[a];t[a]=s(t[a],r[0]);for(var i=1;i<r.length;i++){var u=s(o,r[i]);t.splice(a+i,0,u)}}return(0,n.reverseColumnsByMeasures)(t)},r.createLocalDataState=function(e){var t,n=e.dataTree,a=e.rowSettings,i=e.columnSettings,s=e.rowAxes,l=e.columnAxes,c=e.measures,f=e.sort,p=e.fields,d=((t={})[p.columnsData]=p.columnsData,t[p.dataField]=p.dataField,t),m=l.length?(0,r.createTuples)(i,l,n.get(p.columnsData),f,d):c.map((function(e){return{members:[u(e)]}})),g=l.length>0?(0,r.addMultipleMeasures)(m,c):m,v=s.length?(0,r.createTuples)(a,s,n,f,d):[{members:[]}];return{columns:g,data:(0,o.readData)(n,v,g,p,i,a,c),rows:v}}},238:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.splitKeyValue=r.createKey=r.subNode=void 0,r.subNode=function(e,r,t){var n=e.get(r);return n||(n=t||new Map,e.set(r,n)),n},r.createKey=function(e,r){return e+"&"+r},r.splitKeyValue=function(e){var r=e.indexOf("&");return-1!==r?[e.substring(0,r),e.substring(r+1)]:[e,void 0]}},875:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ConfiguratorNavigation=r.PivotGridNavigation=r.HEADERS_ACTION=r.headersReducer=r.compareAxes=r.toData=r.toRows=r.toColumns=r.toTree=r.buildKPIMeasures=r.addKPI=r.parseResponse=r.setFilter=r.setSort=r.createAxisDescriptors=r.createDataState=r.discoverCommands=r.createDiscoverBody=r.fetchDiscover=r.fetchData=r.createRequestBody=void 0;var n=t(426),a=t(179);Object.defineProperty(r,"createRequestBody",{enumerable:!0,get:function(){return a.createRequestBody}});var o=t(51);Object.defineProperty(r,"fetchData",{enumerable:!0,get:function(){return o.fetchData}}),Object.defineProperty(r,"fetchDiscover",{enumerable:!0,get:function(){return o.fetchDiscover}});var i=t(992);Object.defineProperty(r,"createDiscoverBody",{enumerable:!0,get:function(){return i.createDiscoverBody}}),Object.defineProperty(r,"discoverCommands",{enumerable:!0,get:function(){return i.discoverCommands}});var u=t(75);Object.defineProperty(r,"createDataState",{enumerable:!0,get:function(){return u.createDataState}});var s=t(644);Object.defineProperty(r,"createAxisDescriptors",{enumerable:!0,get:function(){return s.createAxisDescriptors}});var l=t(220);Object.defineProperty(r,"setSort",{enumerable:!0,get:function(){return l.setSort}});var c=t(658);Object.defineProperty(r,"setFilter",{enumerable:!0,get:function(){return c.setFilter}});var f=t(659);Object.defineProperty(r,"parseResponse",{enumerable:!0,get:function(){return f.parseResponse}});var p=t(70);Object.defineProperty(r,"addKPI",{enumerable:!0,get:function(){return p.addKPI}}),Object.defineProperty(r,"buildKPIMeasures",{enumerable:!0,get:function(){return p.buildKPIMeasures}}),Object.defineProperty(r,"toTree",{enumerable:!0,get:function(){return p.toTree}}),Object.defineProperty(r,"toColumns",{enumerable:!0,get:function(){return p.toColumns}}),Object.defineProperty(r,"toRows",{enumerable:!0,get:function(){return p.toRows}}),Object.defineProperty(r,"toData",{enumerable:!0,get:function(){return p.toData}}),Object.defineProperty(r,"compareAxes",{enumerable:!0,get:function(){return p.compareAxes}});var d=t(628);Object.defineProperty(r,"headersReducer",{enumerable:!0,get:function(){return d.headersReducer}}),Object.defineProperty(r,"HEADERS_ACTION",{enumerable:!0,get:function(){return d.HEADERS_ACTION}}),n.__exportStar(t(420),r),n.__exportStar(t(150),r),n.__exportStar(t(167),r);var m=t(435);Object.defineProperty(r,"PivotGridNavigation",{enumerable:!0,get:function(){return m.PivotGridNavigation}}),Object.defineProperty(r,"ConfiguratorNavigation",{enumerable:!0,get:function(){return m.ConfiguratorNavigation}})},420:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0})},182:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ConfiguratorNavigation=void 0;var n=t(426),a=t(965),o=[".k-pivotgrid-configurator-content .k-form-field .k-fields-list-wrapper .k-treeview",".k-pivotgrid-configurator-content .k-chip",".k-pivotgrid-configurator-actions button"],i=function(e,r,t,n){t.preventDefault();var a=r.elements,o=a.indexOf(e)+n;o<0&&(o=a.length-1),r.focusElement(a[o%a.length],e)},u=function(e,r,t){t.target instanceof HTMLElement&&t.target.querySelector(".k-icon.k-i-x-circle, .k-svg-icon.k-svg-i-x-circle")instanceof HTMLElement&&(t.preventDefault(),i(e,r,t,-1))},s={keydown:{Tab:function(e,r,t){i(e,r,t,t.shiftKey?-1:1)},Escape:function(e,r,t){if(t.target instanceof HTMLElement&&r.root){var n=r.root.previousElementSibling,a=r.root.nextElementSibling,o=Array.from(n instanceof HTMLElement?n.querySelectorAll("[tabindex]"):[]).find((function(e){return e.tabIndex>=0}));o instanceof HTMLElement&&(o.focus(),a instanceof HTMLElement&&a.click())}},Delete:u,Backspace:u}},l={click:function(e,r){if(e&&e instanceof HTMLElement){var t=r.elements.find((function(e){return e.hasAttribute("tabindex")}))||null;r.focusElement(e,t)}}},c=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.selectors=o,r.mouseEvents=l,r.keyboardEvents=s,r}return n.__extends(r,e),r}(a.Navigation);r.ConfiguratorNavigation=c},435:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ConfiguratorNavigation=r.PivotGridNavigation=void 0;var n=t(175);Object.defineProperty(r,"PivotGridNavigation",{enumerable:!0,get:function(){return n.PivotGridNavigation}});var a=t(182);Object.defineProperty(r,"ConfiguratorNavigation",{enumerable:!0,get:function(){return a.ConfiguratorNavigation}})},965:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.Navigation=void 0;var t=function(){function e(e){this.tabIndex=0,this.root=null,this.eventHandlers={},this.update=function(){},this.tabIndex=e.tabIndex}return Object.defineProperty(e.prototype,"elements",{get:function(){return this.root?Array.from(this.root.querySelectorAll(this.selectors.join(","))):[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"first",{get:function(){return this.root&&this.root.querySelector(this.selectors.join(","))||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"last",{get:function(){var e=this.elements;return e[e.length-1]||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"current",{get:function(){return this.elements.find((function(e){return e.matches(":focus")}))},enumerable:!1,configurable:!0}),e.prototype.start=function(e){var r=this;this.root=e;var t=function(t){n.mouseEvents[t]&&(n.eventHandlers[t]=function(e){var n=e.target instanceof Element&&e.target.closest(r.selectors.join(","));n&&r.mouseEvents[t].call(void 0,n,r,e)},e.addEventListener(t,n.eventHandlers[t]))},n=this;for(var a in this.mouseEvents)t(a);var o=function(t){i.keyboardEvents[t]&&(i.eventHandlers[t]=function(e){var n=e.target instanceof Element&&e.target.closest(r.selectors.join(",")),a=" "===e.key?"Space":e.key;n&&r.keyboardEvents[t][a]&&r.keyboardEvents[t][a].call(void 0,n,r,e)},e.addEventListener(t,i.eventHandlers[t]))},i=this;for(var a in this.keyboardEvents)o(a)},e.prototype.stop=function(){if(this.root)for(var e in this.eventHandlers)this.eventHandlers[e]&&this.root.removeEventListener(e,this.eventHandlers[e]);this.root=null},e.prototype.focusElement=function(e,r){e&&(r&&(r.removeAttribute("tabindex"),r.classList.remove("k-focus")),e.setAttribute("tabindex",String(this.tabIndex)),e.focus({preventScroll:!0}))},e}();r.Navigation=t},175:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PivotGridNavigation=void 0;var n=t(426),a=t(965),o=".k-pivotgrid .k-pivotgrid-values",i=".k-pivotgrid .k-pivotgrid-column-headers",u=".k-pivotgrid .k-pivotgrid-row-headers",s=".k-pivotgrid > .k-pivotgrid-empty-cell",l="table.k-pivotgrid-table",c=".k-pivotgrid-cell",f=[o,i,u].join(","),p=[s,[i,l,c].join(" "),[u,l,c].join(" "),[o,l,c].join(" ")],d=function(e,r,t){var n=e.querySelector(".k-icon, .k-svg-icon");if(n){var a=r.elements.indexOf(e);r.update=function(){r.focusElement(r.elements[a],null),r.update=function(){}},n.click(),t.preventDefault()}},m=function(e,r,t){e.offsetLeft<r.scrollLeft&&(t.scrollLeft=e.offsetLeft)},g=function(e,r,t){e.offsetLeft+e.offsetWidth>r.scrollLeft+r.offsetWidth&&e.offsetWidth<r.offsetWidth&&(t.scrollLeft=e.offsetLeft+e.offsetWidth-r.offsetWidth)},v=function(e,r,t){r.scrollTop&&e.offsetTop<r.scrollTop&&(t.scrollTop=e.offsetTop)},h=function(e,r,t){e.offsetTop+e.offsetHeight>r.scrollTop+r.offsetHeight&&e.offsetHeight<r.offsetHeight&&(t.scrollTop=e.offsetTop+e.offsetHeight-r.offsetHeight)},y=function(e,r,t){var n=r.querySelector(o),a=e&&e.closest(f);n&&a&&e&&t.forEach((function(r){return r(e,a,n)}))},A=function(e){var r=Array.from(e.rows),t=Array.from(r&&r[0]&&r[0].cells||[]).map((function(e){return e.colSpan})).reduce((function(e,r){return e+r}),0),n=r.map((function(){return new Array(t)}));return r.forEach((function(e,r){var t=0;Array.from(e.cells).forEach((function(e){for(var a=0;a<e.colSpan;a++){for(var o=0;o<e.rowSpan;o++){var i=n[r+o].findIndex((function(e,r){return r>=t&&!e}));n[r+o][i]=e}t++}}))})),n},_=function(e){for(var r=A(e.querySelector([i,l].join(" "))),t=A(e.querySelector([u,l].join(" "))),n=A(e.querySelector([o,l].join(" "))),a=e.querySelector(s),c=new Array(t[0].length).fill(a),f=[],p=0;p<r.length;p++)f.push(c.concat(r[p]));for(p=0;p<t.length;p++)f.push(t[p].concat(n[p]));return f},E=function(e){return e.ctrlKey||e.metaKey},N=function(e,r,t){for(var n=_(e),a=function(e,r){for(var t=0;t<e.length;t++)for(var n=0;n<e[t].length;n++)if(e[t][n]===r)return[t,n];return[-1,-1]}(n,r),o=[a[0]+t[0],a[1]+t[1]],i=n[o[0]]&&n[o[0]][o[1]];i&&i===r;)i=n[(o=[o[0]+t[0],o[1]+t[1]])[0]]&&n[o[0]][o[1]];return i},O={keydown:{ArrowLeft:function(e,r,t){t.preventDefault();var n=N(r.root,e,[0,-1]);r.focusElement(n,e),y(n,r.root,[g,m,h,v])},ArrowRight:function(e,r,t){t.preventDefault();var n=N(r.root,e,[0,1]);r.focusElement(n,e),y(n,r.root,[m,g,h,v])},ArrowUp:function(e,r,t){t.preventDefault();var n=N(r.root,e,[-1,0]);r.focusElement(n,e),y(n,r.root,[g,m,h,v])},ArrowDown:function(e,r,t){t.preventDefault();var n=N(r.root,e,[1,0]);r.focusElement(n,e),y(n,r.root,[g,m,v,h])},o:function(e,r,t){if(r.root){var n=r.root.nextElementSibling;n&&n instanceof HTMLElement&&n.matches("div.k-pivotgrid-configurator-button")&&(n.click(),setTimeout((function(){if(r.root.parentNode){var e=r.root.parentNode.querySelector(".k-pivotgrid-configurator-content .k-form-field .k-fields-list-wrapper .k-treeview");e instanceof HTMLElement&&(e.setAttribute("tabindex",String(r.tabIndex)),e.focus())}}),0))}},Enter:d,Space:d,Home:function(e,r,t){var n=_(r.root),a=(E(t)?n[0]:n.find((function(r){return Boolean(r.find((function(r){return r===e})))}))||[])[0];a&&(r.focusElement(a,e),y(a,r.root,[g,m,h,v]),t.preventDefault())},End:function(e,r,t){var n=_(r.root),a=E(t)?n[n.length-1]:n.find((function(r){return Boolean(r.find((function(r){return r===e})))}))||[],o=a&&a[a.length-1]||null;o&&(r.focusElement(o,e),y(o,r.root,[m,g,v,h]),t.preventDefault())}}},x={click:function(e,r){if(e&&e instanceof HTMLElement){var t=r.elements.find((function(e){return e.hasAttribute("tabindex")}))||null;r.focusElement(e,t)}}},I=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.selectors=p,r.mouseEvents=x,r.keyboardEvents=O,r}return n.__extends(r,e),r}(a.Navigation);r.PivotGridNavigation=I},150:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.configuratorReducer=r.PIVOT_CONFIGURATOR_ACTION=void 0;var n,a=t(426),o=t(70);!function(e){e.toggleSelection="PIVOT_CONFIGURATOR_ACTION_TOGGLE_SELECTION",e.addColumnAxis="PIVOT_CONFIGURATOR_ACTION_ADD_COLUMN_AXIS",e.addColumnAxes="PIVOT_CONFIGURATOR_ACTION_ADD_COLUMN_AXES",e.removeColumnAxis="PIVOT_CONFIGURATOR_ACTION_REMOVE_COLUMN_AXIS",e.removeColumnAxes="PIVOT_CONFIGURATOR_ACTION_REMOVE_COLUMN_AXES",e.addRowAxis="PIVOT_CONFIGURATOR_ACTION_ADD_ROW_AXIS",e.addRowAxes="PIVOT_CONFIGURATOR_ACTION_ADD_ROW_AXES",e.removeRowAxis="PIVOT_CONFIGURATOR_ACTION_REMOVE_ROW_AXIS",e.removeRowAxes="PIVOT_CONFIGURATOR_ACTION_REMOVE_ROW_AXES",e.addMeasureAxis="PIVOT_CONFIGURATOR_ACTION_ADD_MEASURE_AXIS",e.addMeasureAxes="PIVOT_CONFIGURATOR_ACTION_ADD_MEASURE_AXES",e.removeMeasureAxis="PIVOT_CONFIGURATOR_ACTION_REMOVE_MEASURE_AXIS",e.removeMeasureAxes="PIVOT_CONFIGURATOR_ACTION_REMOVE_MEASURE_AXES",e.remove="PIVOT_CONFIGURATOR_ACTION_REMOVE",e.setSort="PIVOT_CONFIGURATOR_ACTION_SET_SORT",e.setFilter="PIVOT_CONFIGURATOR_ACTION_SET_FILTER",e.addFilter="PIVOT_CONFIGURATOR_ACTION_ADD_FILTER",e.changeFilter="PIVOT_CONFIGURATOR_ACTION_CHANGE_FILTER",e.removeFilter="PIVOT_CONFIGURATOR_ACTION_REMOVE_FILTER",e.setDragItem="PIVOT_CONFIGURATOR_ACTION_SET_DRAGITEM",e.drop="PIVOT_CONFIGURATOR_ACTION_DROP",e.setDropZone="PIVOT_CONFIGURATOR_ACTION_SET_DROP_ZONE",e.setDropTarget="PIVOT_CONFIGURATOR_ACTION_SET_DROP_TARGET",e.setDropDirection="PIVOT_CONFIGURATOR_ACTION_SET_DROP_DIRECTION"}(n||(r.PIVOT_CONFIGURATOR_ACTION=n={})),r.configuratorReducer=function(e,t){var i,u,s,l,c,f,p,d,m;switch(t.type){case n.toggleSelection:if(!Array.isArray(t.payload)){var g=t.payload;if(2===g.type||"aggregator"in g)return e.measureAxes.some((function(e){return(0,o.compareAxisWithField)(e,g)}))?(0,r.configuratorReducer)(e,a.__assign(a.__assign({},t),{type:n.removeMeasureAxis})):(0,r.configuratorReducer)(e,a.__assign(a.__assign({},t),{type:n.addMeasureAxis}));if("kpi"===g.type){var v=(0,o.buildKPIMeasures)(g);return v.every((function(r){return e.measureAxes.some((function(e){return(0,o.compareAxisWithField)(e,r)}))}))?(0,r.configuratorReducer)(e,a.__assign(a.__assign({},t),{type:n.removeMeasureAxes,payload:v})):(0,r.configuratorReducer)(e,a.__assign(a.__assign({},t),{type:n.addMeasureAxes,payload:v.filter((function(r){return!e.measureAxes.some((function(e){return(0,o.compareAxisWithField)(e,r)}))}))}))}return t.payload.kpi?e.measureAxes.some((function(e){return(0,o.compareAxisWithField)(e,g)}))?(0,r.configuratorReducer)(e,a.__assign(a.__assign({},t),{type:n.removeMeasureAxis})):(0,r.configuratorReducer)(e,a.__assign(a.__assign({},t),{type:n.addMeasureAxis})):e.columnAxes.some((function(e){return(0,o.compareAxisWithField)(e,g)}))?(0,r.configuratorReducer)(e,a.__assign(a.__assign({},t),{type:n.removeColumnAxis})):e.rowAxes.some((function(e){return(0,o.compareAxisWithField)(e,g)}))?(0,r.configuratorReducer)(e,a.__assign(a.__assign({},t),{type:n.removeRowAxis})):!e.columnAxes||!e.columnAxes.length||e.rowAxes&&e.rowAxes.length?(0,r.configuratorReducer)(e,a.__assign(a.__assign({},t),{type:n.addColumnAxis})):(0,r.configuratorReducer)(e,a.__assign(a.__assign({},t),{type:n.addRowAxis}))}break;case n.addColumnAxis:u=a.__spreadArray(a.__spreadArray([],e.columnAxes||[],!0),[{name:[t.payload.defaultHierarchy||t.payload.uniqueName]}],!1);break;case n.addColumnAxes:break;case n.removeColumnAxis:u=a.__spreadArray([],(e.columnAxes||[]).filter((function(e){return!(0,o.compareAxisWithField)(e,t.payload)})),!0),(0,o.filterField)(u,t.payload);break;case n.removeColumnAxes:break;case n.addRowAxis:i=a.__spreadArray(a.__spreadArray([],e.rowAxes||[],!0),[{name:[t.payload.defaultHierarchy||t.payload.uniqueName]}],!1);break;case n.addRowAxes:break;case n.removeRowAxis:i=a.__spreadArray([],(e.rowAxes||[]).filter((function(e){return!(0,o.compareAxisWithField)(e,t.payload)})),!0),(0,o.filterField)(i,t.payload);break;case n.removeRowAxes:break;case n.addMeasureAxis:s=a.__spreadArray(a.__spreadArray([],e.measureAxes||[],!0),[{name:[t.payload.defaultHierarchy||t.payload.uniqueName]}],!1);break;case n.removeMeasureAxis:s=a.__spreadArray([],(e.measureAxes||[]).filter((function(e){return!(0,o.compareAxisWithField)(e,t.payload)})),!0);break;case n.addMeasureAxes:s=a.__spreadArray(a.__spreadArray([],e.measureAxes||[],!0),(t.payload||[]).map((function(e){return{name:[e.defaultHierarchy||e.uniqueName]}})),!0);break;case n.removeMeasureAxes:s=a.__spreadArray([],(e.measureAxes||[]).filter((function(e){return!t.payload.some((function(r){return(0,o.compareAxisWithField)(e,r)}))})),!0);break;case n.remove:e.columnAxes.some((function(e){return(0,o.compareAxes)(e,t.payload)}))&&(u=a.__spreadArray([],e.columnAxes.filter((function(e){return!(0,o.compareAxes)(e,t.payload)})),!0),(0,o.filterField)(u,{uniqueName:t.payload.name})),e.rowAxes.some((function(e){return(0,o.compareAxes)(e,t.payload)}))&&(i=a.__spreadArray([],e.rowAxes.filter((function(e){return!(0,o.compareAxes)(e,t.payload)})),!0),(0,o.filterField)(i,{uniqueName:t.payload.name})),e.measureAxes.some((function(e){return(0,o.compareAxes)(e,t.payload)}))&&(s=a.__spreadArray([],e.measureAxes.filter((function(e){return!(0,o.compareAxes)(e,t.payload)})),!0));break;case n.setDragItem:f=t.payload;break;case n.setDropZone:p=t.payload;break;case n.setDropTarget:m=t.payload;break;case n.setDropDirection:d=t.payload;break;case n.drop:if(e.dragItem&&e.dropZone){var h=e.columnAxes.find((function(e){return(0,o.compareAxes)(e,t.payload)})),y=e.rowAxes.find((function(e){return(0,o.compareAxes)(e,t.payload)})),A=e.measureAxes.find((function(e){return(0,o.compareAxes)(e,t.payload)})),_=void 0;switch(h&&(_=h,u=a.__spreadArray([],e.columnAxes.filter((function(e){return!(0,o.compareAxes)(e,t.payload)})),!0),(0,o.filterField)(u,{uniqueName:t.payload.name})),y&&(_=y,i=a.__spreadArray([],e.rowAxes.filter((function(e){return!(0,o.compareAxes)(e,t.payload)})),!0),(0,o.filterField)(i,{uniqueName:t.payload.name})),A&&(_=A,s=a.__spreadArray([],e.measureAxes.filter((function(e){return!(0,o.compareAxes)(e,t.payload)})),!0)),e.dropZone){case"columnAxes":u=u||e.columnAxes.slice(),(0,o.insertAxis)(u,_,e);break;case"rowAxes":i=i||e.rowAxes.slice(),(0,o.insertAxis)(i,_,e);break;case"measureAxes":s=s||e.measureAxes.slice(),(0,o.insertAxis)(s,_,e)}}f=null,p=null,m=null;break;case n.setSort:l=t.payload;break;case n.setFilter:c=Array.isArray(t.payload)?t.payload:[t.payload];break;case n.addFilter:c=(e.filter||[]).slice(),Array.isArray(t.payload)?c.push.apply(c,t.payload):c.push(t.payload);break;case n.changeFilter:c=Array.isArray(t.payload)?(e.filter||[]).map((function(e){return t.payload.some((function(r){return r.field===e.field}))?t.payload.find((function(r){return r.field===e.field})):e})):(e.filter||[]).map((function(e){return e.field===t.payload.field?t.payload:e}));break;case n.removeFilter:c=(e.filter||[]).slice(),c=Array.isArray(t.payload)?c.filter((function(e){return!t.payload.some((function(r){return r.field===e.field&&r.operator===e.operator}))})):c.filter((function(e){return!(e.field===t.payload.field&&e.operator===t.payload.operator)}))}return{dragItem:f,dropTarget:m,dropDirection:d,dropZone:p,columnAxes:u,rowAxes:i,measureAxes:s,filter:c,sort:l}}},560:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.headersReducer=r.HEADERS_ACTION=void 0;var n,a=t(426);!function(e){e.toggle="HEADERS_ACTION_TOGGLE",e.expand="HEADERS_ACTION_EXPAND",e.collapse="HEADERS_ACTION_COLLAPSE"}(n||(r.HEADERS_ACTION=n={}));var o=function(e,r,t){var n=new Set;return e.children.forEach((function(e){var a=r(e);t&&n.add(String(e.path)),o(e,r,t||a).map((function(e){n.add(e)}))})),Array.from(n.values())};r.headersReducer=function(e,t){switch(t.type){case n.toggle:var i=e.find((function(e){return String(e.name)===String(t.payload)}));return(0,r.headersReducer)(e,a.__assign(a.__assign({},t),{type:i&&i.expand?n.collapse:n.expand}));case n.expand:var u=e.find((function(e){return String(e.name)===String(t.payload)}));if(u&&!0===u.expand)return e;if(!u||!1!==u.expand&&void 0!==u.expand){var s=e.slice();return s.push({name:t.payload,expand:!0}),s}return e.map((function(e){return e===u?a.__assign(a.__assign({},u),{expand:!0}):e}));case n.collapse:var l=o(t.tree,(function(e){return!e.total&&String(e.path)===String(t.payload)}));return e.slice().filter((function(e){return!l.some((function(r){return r===String(e.name)}))})).map((function(e){return a.__assign(a.__assign({},e),{expand:Boolean(e.expand)})})).map((function(e){return String(e.name)===String(t.payload)?t.payload.length>1?void 0:{name:t.payload,expand:!1}:e})).filter(Boolean);default:return e}}},628:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0});var n=t(426);n.__exportStar(t(560),r),n.__exportStar(t(150),r)},992:(e,r)=>{function t(e,r,t){var n="";if(r){n+="<"+e+">";var a=void 0;for(var o in r)r[o]&&(a=r[o],t&&(o=o.replace(/([A-Z]+(?=$|[A-Z][a-z])|[A-Z]?[a-z]+)/g,"$1_").toUpperCase().replace(/_$/,"")),n+="<"+o+">"+a+"</"+o+">");n+="</"+e+">"}else n+="<"+e+"/>";return n}Object.defineProperty(r,"__esModule",{value:!0}),r.discoverCommands=void 0,r.createDiscoverBody=function(e){var n={},a='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis">';return a+="<RequestType>"+(r.discoverCommands[e.command]||e.command)+"</RequestType>",a+="<Restrictions>"+t("RestrictionList",e.restrictions,!0)+"</Restrictions>",e.connection&&e.connection.catalog&&(n.Catalog=e.connection.catalog),(a+="<Properties>"+t("PropertyList",n,!1)+"</Properties>")+"</Discover></Body></Envelope>"},r.discoverCommands={schemaCatalogs:"DBSCHEMA_CATALOGS",schemaCubes:"MDSCHEMA_CUBES",schemaDimensions:"MDSCHEMA_DIMENSIONS",schemaHierarchies:"MDSCHEMA_HIERARCHIES",schemaKPIs:"MDSCHEMA_KPIS",schemaLevels:"MDSCHEMA_LEVELS",schemaMeasures:"MDSCHEMA_MEASURES",schemaMembers:"MDSCHEMA_MEMBERS"}},51:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.fetchDiscover=r.fetchData=void 0;var n=t(426),a=t(179),o=t(659),i=t(992),u=t(379),s={schemaCatalogs:u.parseCatalogs,schemaCubes:u.parseCubes,schemaDimensions:u.parseDimensions,schemaHierarchies:u.parseHierarchies,schemaKPIs:u.parseKPIs,schemaLevels:u.parseLevels,schemaMeasures:u.parseMeasures,schemaMembers:u.parseMembers};r.fetchData=function(e,r){return n.__awaiter(void 0,void 0,void 0,(function(){var t,i;return n.__generator(this,(function(u){switch(u.label){case 0:return t=n.__assign({body:(0,a.createRequestBody)(r),headers:{"Content-Type":"text/xml"},method:"POST"},e.init),[4,fetch(e.url,t)];case 1:return[4,u.sent().text()];case 2:return i=u.sent(),[2,(0,o.parseResponse)(i)]}}))}))},r.fetchDiscover=function(e,r){return n.__awaiter(void 0,void 0,void 0,(function(){var t,a;return n.__generator(this,(function(o){switch(o.label){case 0:return t=n.__assign({body:(0,i.createDiscoverBody)(r),headers:{"Content-Type":"text/xml"},method:"POST"},e.init),[4,fetch(e.url,t)];case 1:return[4,o.sent().text()];case 2:return a=o.sent(),[2,s[r.command](a)]}}))}))}},179:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.createRequestBody=function(e){var r='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Execute xmlns="urn:schemas-microsoft-com:xml-analysis"><Command><Statement>',t=e.columnAxes,o=void 0===t?[]:t,i=e.rowAxes,u=void 0===i?[]:i,s=e.measureAxes,l=void 0===s?[]:s,c=e.sort,f=void 0===c?[]:c,p=e.filter,d=void 0===p?[]:p,m="rows"===e.measuresAxis;return r+="SELECT NON EMPTY {",!o.length&&u.length&&(!l.length||l.length&&m)&&(o=u,u=[],m=!1),o.length||u.length||(m=!1),o.length?r+=(0,a.serializeMembers)(o,m?[]:l,f):l.length&&!m&&(r+=(0,a.measureNames)(l).join(",")),r+="} DIMENSION PROPERTIES CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME ON COLUMNS",(u.length||m&&l.length>1)&&(r+=", NON EMPTY {",u.length?r+=(0,a.serializeMembers)(u,m?l:[],f):r+=(0,a.measureNames)(l).join(","),r+="} DIMENSION PROPERTIES CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME ON ROWS"),d.length?(r+=" FROM ",r+="(",r+=(0,n.serializeFilters)(d,e.connection.cube),r+=")"):r+=" FROM ["+e.connection.cube+"]",(r+="</Statement></Command><Properties><PropertyList><Catalog>"+e.connection.catalog+"</Catalog><Format>Multidimensional</Format></PropertyList></Properties></Execute></Body></Envelope>").replace(/&/g,"&amp;")};var n=t(574),a=t(694)},574:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.serializeFilters=function(e,r){for(var t="",n="",o=e.length-1;o>=0;o--)n="SELECT (",n+=a(e[o]),n+=") ON 0",t=o===e.length-1?n+=" FROM ["+r+"]":n+" FROM ( "+t+" )";return t};var t={contains:', InStr({0}.CurrentMember.MEMBER_CAPTION,"{1}") > 0',doesnotcontain:', InStr({0}.CurrentMember.MEMBER_CAPTION,"{1}")',endswith:', Right({0}.CurrentMember.MEMBER_CAPTION,Len("{1}"))="{1}"',eq:', {0}.CurrentMember.MEMBER_CAPTION = "{1}"',neq:', {0}.CurrentMember.MEMBER_CAPTION = "{1}"',startswith:', Left({0}.CurrentMember.MEMBER_CAPTION,Len("{1}"))="{1}"'},n={doesnotcontain:"doesnotcontain",in:"in",neq:"neq"};function a(e){var r="",a=String(e.value),o=e.field,i=e.operator;return i===n.in?(r+="{",r+=a,r+="}"):(r+=i===n.neq||i===n.doesnotcontain?"-":"",r+="Filter(",r+=o+".MEMBERS",r+=function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return r.forEach((function(r,t){e=e.replace(new RegExp("\\{".concat(t,"\\}"),"g"),r)})),e}(t[i],o,a),r+=")"),r}},694:(e,r)=>{function t(e){for(var r,t=e.length,n=[],a=0;a<t;a++)r=e[a],n.push(void 0!==r.name?r.name:r);return n}function n(e,r){var t=r.length;r=r.slice(0);for(var n=0;n<e.length;n++)for(var a=e[n],o=0;o<t;o++){var u=i(r[o]);if(-1!==a.indexOf(u)){r[o]=a;break}}return r}function a(e,r){var n=e.slice(0);return r.length>0&&n.push("{"+t(r).join(",")+"}"),u(n)}function o(e,r){var t=e.length-1,n=e[t],a=function(e,r){for(var t=0,n=e.length;t<n;t++)if(0===r.indexOf(e[t].field))return e[t];return null}(r,n);return a&&a.dir?n="ORDER("+n+".Children,"+a.field+".CurrentMember.MEMBER_CAPTION,"+a.dir+")":n+=".Children",e[t]=n,e}function i(e){var r=e.split(".");return r.length>2?r[0]+"."+r[1]:e}function u(e){var r,t="CROSSJOIN({";return e.length>2?(r=e.pop(),t+=u(e)):(t+=e.shift(),r=e.pop()),t+="},{",(t+=r)+"})"}Object.defineProperty(r,"__esModule",{value:!0}),r.serializeMembers=function(e,r,t){var u,s="",l=function(e){for(var r,t=[],n=[],a=[],o=0;o<e.length;o++){var u=e[o],s=u.name;if(r=!1,s.length>1)n.push(u);else{for(var l=i(s[0]),c=0,f=a.length;c<f;c++)if(0===a[c].name[0].indexOf(l)){r=!0;break}r||a.push(u),u.expand&&t.push(u)}}return{expanded:t=t.concat(n),root:a}}(e=e||[]),c=l.expanded,f=function(e){var r=[];return e.forEach((function(e){var t=e.name[0],n=i(t);r.some((function(e){return 0===e.indexOf(n)}))||r.push(t)})),r}(l.root),p=[],d=c.length,m=0,g=[];if(f.length>1||r.length>0){for(p.push(a(f,r));m<d;m++)g=n(u=o(c[m].name,t),f),p.push(a(g,r));s+=p.join(",")}else{for(;m<d;m++)u=o(c[m].name,t),g.push(u[0]);s+=f.concat(g).join(",")}return s},r.measureNames=t},379:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.parseCubes=function(e){var r=(new DOMParser).parseFromString(e,"text/xml");return Array.from(r.querySelectorAll("DiscoverResponse > return > root > row")).map((function(e){return{name:(0,n.getPropertyValue)(e,"CUBE_NAME"),caption:(0,n.getPropertyValue)(e,"CUBE_CAPTION"),description:(0,n.getPropertyValue)(e,"DESCRIPTION"),type:(0,n.getPropertyValue)(e,"CUBE_TYPE")}}))},r.parseCatalogs=function(e){var r=(new DOMParser).parseFromString(e,"text/xml");return Array.from(r.querySelectorAll("DiscoverResponse > return > root > row")).map((function(e){return{name:(0,n.getPropertyValue)(e,"CATALOG_NAME"),description:(0,n.getPropertyValue)(e,"DESCRIPTION")}}))},r.parseMeasures=function(e){var r=(new DOMParser).parseFromString(e,"text/xml");return Array.from(r.querySelectorAll("DiscoverResponse > return > root > row")).map((function(e){return{name:(0,n.getPropertyValue)(e,"MEASURE_NAME"),caption:(0,n.getPropertyValue)(e,"MEASURE_CAPTION"),uniqueName:(0,n.getPropertyValue)(e,"MEASURE_UNIQUE_NAME"),description:(0,n.getPropertyValue)(e,"DESCRIPTION"),aggregator:(0,n.getPropertyValue)(e,"MEASURE_AGGREGATOR"),groupName:(0,n.getPropertyValue)(e,"MEASUREGROUP_NAME"),displayFolder:(0,n.getPropertyValue)(e,"MEASURE_DISPLAY_FOLDER"),defaultFormat:(0,n.getPropertyValue)(e,"DEFAULT_FORMAT_STRING")}}))},r.parseKPIs=function(e){var r=(new DOMParser).parseFromString(e,"text/xml");return Array.from(r.querySelectorAll("DiscoverResponse > return > root > row")).map((function(e){return{name:(0,n.getPropertyValue)(e,"KPI_NAME"),uniqueName:(0,n.getPropertyValue)(e,"KPI_NAME"),caption:(0,n.getPropertyValue)(e,"KPI_CAPTION"),value:(0,n.getPropertyValue)(e,"KPI_VALUE"),goal:(0,n.getPropertyValue)(e,"KPI_GOAL"),status:(0,n.getPropertyValue)(e,"KPI_STATUS"),trend:(0,n.getPropertyValue)(e,"KPI_TREND"),statusGraphic:(0,n.getPropertyValue)(e,"KPI_STATUS_GRAPHIC"),trendGraphic:(0,n.getPropertyValue)(e,"KPI_TREND_GRAPHIC"),description:(0,n.getPropertyValue)(e,"KPI_DESCRIPTION"),groupName:(0,n.getPropertyValue)(e,"MEASUREGROUP_NAME"),type:"kpi"}}))},r.parseDimensions=function(e){var r=(new DOMParser).parseFromString(e,"text/xml");return Array.from(r.querySelectorAll("DiscoverResponse > return > root > row")).map((function(e){return{caption:(0,n.getPropertyValue)(e,"DIMENSION_CAPTION"),defaultHierarchy:(0,n.getPropertyValue)(e,"DEFAULT_HIERARCHY"),description:(0,n.getPropertyValue)(e,"DESCRIPTION"),name:(0,n.getPropertyValue)(e,"DIMENSION_NAME"),type:parseInt((0,n.getPropertyValue)(e,"DIMENSION_TYPE"),10),uniqueName:(0,n.getPropertyValue)(e,"DIMENSION_UNIQUE_NAME")}}))},r.parseHierarchies=function(e){var r=(new DOMParser).parseFromString(e,"text/xml");return Array.from(r.querySelectorAll("DiscoverResponse > return > root > row")).map((function(e){return{name:(0,n.getPropertyValue)(e,"HIERARCHY_NAME"),caption:(0,n.getPropertyValue)(e,"HIERARCHY_CAPTION"),description:(0,n.getPropertyValue)(e,"DESCRIPTION"),uniqueName:(0,n.getPropertyValue)(e,"HIERARCHY_UNIQUE_NAME"),dimensionUniqueName:(0,n.getPropertyValue)(e,"DIMENSION_UNIQUE_NAME"),displayFolder:(0,n.getPropertyValue)(e,"HIERARCHY_DISPLAY_FOLDER"),origin:(0,n.getPropertyValue)(e,"HIERARCHY_ORIGIN"),defaultMember:(0,n.getPropertyValue)(e,"DEFAULT_MEMBER")}}))},r.parseLevels=function(e){var r=(new DOMParser).parseFromString(e,"text/xml");return Array.from(r.querySelectorAll("DiscoverResponse > return > root > row")).map((function(e){return{name:(0,n.getPropertyValue)(e,"LEVEL_NAME"),caption:(0,n.getPropertyValue)(e,"LEVEL_CAPTION"),description:(0,n.getPropertyValue)(e,"DESCRIPTION"),uniqueName:(0,n.getPropertyValue)(e,"LEVEL_UNIQUE_NAME"),dimensionUniqueName:(0,n.getPropertyValue)(e,"DIMENSION_UNIQUE_NAME"),displayFolder:(0,n.getPropertyValue)(e,"LEVEL_DISPLAY_FOLDER"),orderingProperty:(0,n.getPropertyValue)(e,"LEVEL_ORDERING_PROPERTY"),origin:(0,n.getPropertyValue)(e,"LEVEL_ORIGIN"),hierarchyUniqueName:(0,n.getPropertyValue)(e,"HIERARCHY_UNIQUE_NAME")}}))},r.parseMembers=function(e){var r=(new DOMParser).parseFromString(e,"text/xml");return Array.from(r.querySelectorAll("DiscoverResponse > return > root > row")).map((function(e){return{name:(0,n.getPropertyValue)(e,"MEMBER_NAME"),caption:(0,n.getPropertyValue)(e,"MEMBER_CAPTION"),uniqueName:(0,n.getPropertyValue)(e,"MEMBER_UNIQUE_NAME"),dimensionUniqueName:(0,n.getPropertyValue)(e,"DIMENSION_UNIQUE_NAME"),hierarchyUniqueName:(0,n.getPropertyValue)(e,"HIERARCHY_UNIQUE_NAME"),levelUniqueName:(0,n.getPropertyValue)(e,"LEVEL_UNIQUE_NAME"),childrenCardinality:(0,n.getPropertyValue)(e,"CHILDREN_CARDINALITY")}}))};var n=t(659)},659:(e,r)=>{function t(e,r){var t=e.querySelector(r);return t?t.textContent:""}Object.defineProperty(r,"__esModule",{value:!0}),r.parseResponse=function(e){var r=(new DOMParser).parseFromString(e,"text/xml"),n=Array.from(r.querySelectorAll("Axis")),a=Array.from(r.querySelectorAll("CellData > Cell")).map((function(e){return{fmtValue:t(e,"FmtValue"),ordinal:parseInt(e.getAttribute("CellOrdinal"),10),value:t(e,"Value")}})),o={tuples:[]},i={tuples:[]},u=[];n.forEach((function(e){if("SlicerAxis"!==e.getAttribute("name")){var r=0===o.tuples.length?o.tuples:i.tuples;Array.prototype.push.apply(r,function(e){return Array.from(e.querySelectorAll("Tuple")).map((function(e){return{members:Array.from(e.querySelectorAll("Member")).map((function(e){var r=parseInt(t(e,"LNum")||"0",10),n=parseInt(t(e,"CHILDREN_CARDINALITY")||"0",10)>0;return{caption:t(e,"Caption"),children:[],hasChildren:n,hierarchy:e.getAttribute("Hierarchy"),levelName:t(e,"LName"),levelNum:r,name:t(e,"UName"),parentName:t(e,"PARENT_UNIQUE_NAME")}}))}}))}(e))}}));var s=new Array(i.tuples.length*o.tuples.length).fill(null);a.forEach((function(e){s[e.ordinal]=e}));var l=0;return i.tuples.forEach((function(e){o.tuples.forEach((function(r){u.push({columnTuple:r,data:s[l],rowTuple:e}),l++}))})),{columns:o,data:u,rows:i}},r.getPropertyValue=t},70:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.reverseColumnsByMeasures=r.insertAxis=r.filterField=r.compareAxes=r.compareAxisWithField=r.addKPI=r.cloneDate=r.toRows=r.toColumns=r.toData=r.toTree=r.toMatrix=r.generatePath=r.generateNormalizedPath=r.getMaxExpansion=r.getMaxNesting=void 0,r.clone=function(e){var r={};return i(e,r),r},r.cloneObject=i,r.cloneValue=u,r.copy=s,r.cloneArray=l,r.buildKPIMeasures=function(e){var r=e.name;return[c(r,e.value,"value"),c(r,e.goal,"goal"),c(r,e.status,"status"),c(r,e.trend,"trend")]};var n=t(426),a=function(e){return"[Measures]"===e.hierarchy};r.getMaxNesting=function(e,t){return void 0===t&&(t=new Set),(e.children||[]).forEach((function(e){t.add(e.levelName),(0,r.getMaxNesting)(e,t)})),t.size},r.getMaxExpansion=function(e){var t=0;return(e.children||[]).forEach((function(e){t+=(0,r.getMaxExpansion)(e)||1})),t},r.generateNormalizedPath=function(e,r){return(r&&r.hierarchy===e.hierarchy?n.__spreadArray(n.__spreadArray([],(r.normalizedPath||[]).slice(0,-1),!0),[e.name||null],!1):n.__spreadArray(n.__spreadArray([],r&&r.normalizedPath?r.normalizedPath:[],!0),[e.name],!1)).filter(Boolean)},r.generatePath=function(e,r){return(r&&r.hierarchy===e.hierarchy?n.__spreadArray(n.__spreadArray([],(r.path||[]).slice(0,-1),!0),[(0===e.levelNum?e.hierarchy:e.name)||null],!1):n.__spreadArray(n.__spreadArray([],r&&r.path?r.path:[],!0),[0===e.levelNum?e.hierarchy:e.name],!1)).filter(Boolean)},r.toMatrix=function(e,t,n,a,o,i,u,s){void 0===t&&(t=-1),void 0===n&&(n=0),void 0===a&&(a=void 0),void 0===o&&(o=void 0),void 0===i&&(i=void 0),void 0===u&&(u=void 0),void 0===s&&(s=void 0);var l=(0,r.getMaxNesting)(e),c=(0,r.getMaxExpansion)(e),f=a||l,p=o||c,d=i?i.slice():[],m=u?u.slice():new Array(p),g=d.findIndex((function(r){return r&&r.name===e.levelName&&r.level===e.levelNum})),v=d[g],h={name:e.levelName,level:e.levelNum,index:t,cells:new Array(p).fill(null)},y=-1!==t&&-1!==n,A={caption:e.caption,name:e.name,levelName:e.levelName,levelNum:e.levelNum,hasChildren:e.hasChildren,parentName:e.parentName,hierarchy:e.hierarchy,total:void 0!==e.total&&e.total||s&&s.children.length<=1&&s.total,parent:s,rowIndex:t,colIndex:n,depth:1,breadth:1,path:e.path||[],normalizedPath:e.normalizedPath||[],children:e.children.filter((function(r){return r.hierarchy===e.hierarchy}))};if(y)if(v)v.cells[n]=A,v.index>=t&&(t=v.index);else if(d[t]&&d[t].cells.length){for(var _=t;_<d.length;_++)d[_].index++;d.splice(t,0,h),d[t].cells[n]=A}else d[t]=h,d[t].cells[n]=A;var E=0;return e.children&&e.children.length?e.children.forEach((function(e){var a=(0,r.toMatrix)(e,t+1,n+E,f,p,d,m,A),o=a[0],i=a[1],u=a[3];E+=u||1,d=o.slice(),m=i.slice()})):e.normalizedPath&&(m[n]={total:A.total,path:e.normalizedPath}),A.depth=l,A.breadth=c,[d,m,l,c]};var o=function(e,r,t){var a;void 0===r&&(r=null),void 0===t&&(t=0);for(var i=n.__assign(n.__assign({},e),{total:!0,hasChildren:!1,children:[]}),u=0;u<e.children.length;u++){var s=o(e.children[u],e,u);a=a||s.hierarchy,s.hierarchy===a||!r||r.children.some((function(e){return e.total&&e.name===i.name}))||e.total||(i.children.push(s),e.children.splice(u,1),u--)}if(e.children.filter((function(e){return!e.total})).length>=1&&r&&!r.children.some((function(e){return e.total&&e.name===i.name}))&&!e.total){var l=e.children[0].hierarchy;e.hierarchy===l&&r.children.splice(t+1,0,i)}return e};function i(e,r){for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];r[t]=u(n,r[t])}}function u(e,t){if(Array.isArray(e))return l(e);if(e instanceof Date)return(0,r.cloneDate)(e);if(e&&"object"==typeof e){var n=t||{};return i(e,n),n}return e}function s(e){return JSON.parse(JSON.stringify(e))}function l(e){return e.map((function(e){return u(e,void 0)}))}r.toTree=function(e){var t={children:[]},i={};if(e.every((function(e){return 1===e.members.length&&a(e.members[0])})))return{children:e.map((function(e){var r=e.members[0];return n.__assign(n.__assign({},r),{normalizedPath:[r.name],parentName:r.name,path:[r.hierarchy]})}))};for(var u=0;u<e.length;u++)for(var l=s(e[u]),c="",f=function(e){var n,a=l.members[e];if(t.children&&0===t.children.length)n=t;else if(i[c]&&!i[c+a.name]&&0===a.levelNum)n=i[c];else if(i[c+a.parentName]&&a.levelNum>0&&!i[c+a.parentName+a.name])n=i[c+a.parentName];else if(!i[c+a.parentName]&&a.levelNum>0&&!i[c+a.parentName+a.name]){var o=Object.keys(i).find((function(e){return a.parentName===i[e].name}));o&&(n=i[o])}if(n){a.path=(0,r.generatePath)(a,n),a.normalizedPath=(0,r.generateNormalizedPath)(a,n);var u=n.children.findIndex((function(e){return e.hierarchy!==n.hierarchy}));-1!==u?n.children.splice(u,0,a):n.children.push(a)}a.parentName+=a.name,c+=a.parentName,i[c]||(i[c]=a)},p=0;p<l.members.length;p++)f(p);return s(o(t))},r.toData=function(e,r,t,n,a){var o=Array.from(new Array(a),(function(){return{cells:Array.from(new Array(n),(function(){return null}))}})),i=function(e){return e.join("|")},u=function(e){return e.members.map((function(e){return e.name}))},s=new Map,l=new Map;return r.forEach((function(e,r){s.set(i(e.path),r)})),t.forEach((function(e,r){l.set(i(e.path),r)})),e.forEach((function(e){var r=s.get(i(u(e.columnTuple))),n=l.get(i(u(e.rowTuple)));void 0!==r&&void 0!==n&&(o[n].cells[r]||(o[n].row=t[n].path,o[n].cells[r]=e))})),o},r.toColumns=function(e){for(var t=(0,r.toMatrix)(e),n=t[0],a=t[1],o=t[2],i=t[3],u=0;u<i;u++)for(var s=null,l=0;l<o;l++)if(n[l]){var c=n[l].cells[u];!c&&s&&(s.rowSpan=(s.rowSpan||1)+1),s&&(s.colSpan=s.breadth||1),c&&(s=c)}return[n,a,o,i]},r.toRows=function(e){for(var t=(0,r.toMatrix)(e),a=t[0],o=t[1],i=t[2],u=t[3],s=0;s<u;s++)for(var l=null,c=0;c<i;c++)if(a[c]){var f=a[c].cells[s];!f&&l&&(l.rowSpan=(l.rowSpan||1)+1),l&&(l.colSpan=l.breadth),f&&(l=f)}return function(e,r,t,a){for(var o=new Array(a),i=0;i<a;i++)for(var u=0;u<t;u++)if(e[u]&&e[u].cells[i]){var s=e[u].cells[i];o[i]||(o[i]={cells:new Array(t).fill(null)}),o[i].cells[u]=n.__assign(n.__assign({},s),{rowSpan:s.colSpan,colSpan:s.rowSpan})}return[o,r,a,t]}(a,o,i,u)},r.cloneDate=function(e){return e?new Date(e.getTime()):null};var c=function(e,r,t){return{hierarchyUniqueName:e,uniqueName:r,caption:r,measure:r,name:r,type:t,kpi:!0}};r.addKPI=function(e){for(var r,t=0;t<e.length;t++)if(2===e[t].type){r=!0;break}r&&e.splice(t+1,0,{caption:"KPIs",defaultHierarchy:"[KPIs]",name:"KPIs",uniqueName:"[KPIs]"})},r.compareAxisWithField=function(e,r){return String(e.name)===String([r.defaultHierarchy?r.defaultHierarchy:r.uniqueName])},r.compareAxes=function(e,r){return String(e.name)===String(r.name)},r.filterField=function(e,t){for(var a=function(a){var o=e[a],i=o.name.findIndex((function(e){return(0,r.compareAxisWithField)({name:[e]},t)||String(e).startsWith(t.uniqueName)}));if(-1!==i)if(i===o.name.length-1||1===o.name.length)e.splice(a,1);else{o.name.splice(i,1);var u=e.findIndex((function(e){return e!==o&&String(e.name)===String(o.name)}));-1!==u&&(e[u]=n.__assign(n.__assign(n.__assign({},e[u]),o),e[u].expand||o.expand?{expand:!0}:{}),e.splice(a,1))}},o=e.length-1;o>=0;o--)a(o)},r.insertAxis=function(e,t,a){var o=-1;if(a.dropTarget&&a.dropDirection){var i=a.dropDirection?"before"===a.dropDirection?0:1:0;o=e.findIndex((function(e){return(0,r.compareAxes)(e,a.dropTarget)}))+i}-1!==o?(e.forEach((function(e){var r;e.expand&&e.name.length>1&&e.name.length>o&&(r=e.name).splice.apply(r,n.__spreadArray([o,0],t.name,!1))})),e.splice(o,0,t)):e.push(t)},r.reverseColumnsByMeasures=function(e){var r=e.length&&e[0],t=r&&r.members[r.members.length-1];if(t&&a(t)){for(var n=[],o=new Set(e.map((function(e){return e.members[e.members.length-1].caption}))).size,i=0;i<e.length;i+=o)n.push(e.slice(i,i+o));var u=[];return n.forEach((function(e){u.push.apply(u,e.reverse())})),u}return e}},161:r=>{r.exports=e},426:e=>{e.exports=r}},n={};return function e(r){var a=n[r];if(void 0!==a)return a.exports;var o=n[r]={exports:{}};return t[r](o,o.exports,e),o.exports}(875)})()));