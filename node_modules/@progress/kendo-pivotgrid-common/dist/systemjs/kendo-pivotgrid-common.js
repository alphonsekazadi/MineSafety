System.register("@progress/kendo-pivotgrid-common",["@progress/kendo-data-query","tslib"],function(e,r){var t={},o={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(o,"__esModule",{value:!0}),{setters:[function(r){Object.keys(r).forEach(function(e){t[e]=r[e]})},function(r){Object.keys(r).forEach(function(e){o[e]=r[e]})}],execute:function(){var n,a;e((n={75:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.createDataState=void 0;var n=t(70);r.createDataState=function(e){return{columns:(0,n.reverseColumnsByMeasures)(e.columns.tuples),data:e.data,rows:e.rows.tuples}}},644:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.createAxisDescriptors=function(e){for(var r=[],t=0,n=Object.keys(e);t<n.length;t++){var a=n[t];r.push({name:JSON.parse(a),expand:e[a]})}return r}},658:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.setFilter=void 0,r.setFilter=function(e,r){e.filter=r=void 0===r?[]:r}},220:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.setSort=void 0,r.setSort=function(e,r){e.sort=r=void 0===r?[]:r}},191:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.averageAggregate=r.maxAggregate=r.minAggregate=r.countAggregate=r.sumAggregate=r.createAggregate=r.AggregateType=void 0,(t=o||(r.AggregateType=o={}))[t.Sum=0]="Sum",t[t.Count=1]="Count",t[t.Min=2]="Min",t[t.Max=3]="Max",t[t.Average=4]="Average";var o,t,i=0;r.createAggregate=function(e){var t="".concat(o[e],"_").concat(i++);switch(e){case o.Sum:return{init:function(e){t in e==0&&(e[t]=0)},merge:function(e,r){r[t]+=e[t]},accumulate:function(e,r){e[t]+=r},result:function(e){return e[t]},format:function(e){return e.toFixed(2)}};case o.Count:return{init:function(e){t in e==0&&(e[t]=0)},merge:function(e,r){r[t]+=e[t]},accumulate:function(e,r){e[t]+=1},result:function(e){return e[t]},format:function(e){return e.toFixed()}};case o.Min:return{init:function(e){t in e==0&&(e[t]=Number.POSITIVE_INFINITY)},merge:function(e,r){r[t]=Math.min(e[t],r[t])},accumulate:function(e,r){e[t]=Math.min(r,e[t])},result:function(e){return Number.isFinite(e[t])?e[t]:NaN},format:function(e){return e.toFixed(2)}};case o.Max:return{init:function(e){t in e==0&&(e[t]=Number.NEGATIVE_INFINITY)},merge:function(e,r){r[t]=Math.max(e[t],r[t])},accumulate:function(e,r){e[t]=Math.max(r,e[t])},result:function(e){return Number.isFinite(e[t])?e[t]:NaN},format:function(e){return e.toFixed(2)}};case o.Average:var n="".concat(t,"_sum"),a="".concat(t,"_count");return{init:function(e){a in e==0&&(e[n]=0,e[a]=0)},merge:function(e,r){r[n]+=e[n],r[a]+=e[a]},accumulate:function(e,r){e[n]+=r,e[a]+=1},result:function(e){return e[n]/e[a]},format:function(e){return e.toFixed(2)}};default:throw new Error("Invalid aggregate type provided")}},r.sumAggregate=(0,r.createAggregate)(o.Sum),r.countAggregate=(0,r.createAggregate)(o.Count),r.minAggregate=(0,r.createAggregate)(o.Min),r.maxAggregate=(0,r.createAggregate)(o.Max),r.averageAggregate=(0,r.createAggregate)(o.Average)},908:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.readData=void 0;function d(r,e,t){var n,a=(o=(0,h.splitKeyValue)(r))[0],o=o[1],t=t.slice();return a&&o?(o=e.find(function(e){return e.key===a}),n=o?o.caption:"",t.map(function(e){return e===n?r:e})):t}function m(e,r,i,u,s,l,t){for(var c=t||new Map,f=u.map(function(e){return e.caption});1<r.length&&u.some(function(e){return e.caption===r[r.length-1].caption});)r.pop(),f.pop();var p=e;return r.forEach(function(r,e){if(f=d(r.name,u,f),p&&!u.some(function(e){return e.caption===r.name})){if(!p.has(r.name)&&!c.has(f.slice(0,f.indexOf(r.name)+1).join("-")))for(var t=Array.from(p).find(function(e){return e[0]!==i}),t=t&&t[0],n=t&&(0,h.splitKeyValue)(t)[0],a=n?e-u.findIndex(function(e){return e.key===n}):0,o=0;o<a;o++)(()=>{var t=[],a=(p.forEach(function(e,r){r!==i&&t.push.apply(t,Array.from(e).filter(function(e){return e[0]!==i}))}),new Map),n=(t.forEach(function(e){var r,t,n;a.has(e[0])?(r=a.get(e[0]),t=e[1],n=new Map,(0,g.mergeTrees)(r,n,s,l),(0,g.mergeTrees)(t,n,s,l),a.set(e[0],n)):a.set(e[0],new Map(e[1]))}),f.slice(0,f.indexOf(r.name)));a.forEach(function(e,r){c.set(d(r,u,n.concat([r])).join("-"),e)}),a.set(i,p.get(i)),p=a})();p=p.get(r.name)||c.get(f.slice(0,f.indexOf(r.name)+1).join("-"))}}),p}var g=t(111),h=t(238);r.readData=function(r,e,t,n,s,a,l){var c=[],f=n.dataField,o=n.columnsData,p=new Map;return e.forEach(function(i){var e=m(r,i.members.slice(),o,a,l,f,p),u=e&&e.get(o);t.forEach(function(e){var r,t=e.members.slice(),n=l[0],t=("[Measures].[MeasuresLevel]"===t[t.length-1].levelName&&(r=t.pop(),n=l.find(function(e){return String(e.name)===r.caption})||n),u&&m(u,t,f,s,l,f)),a="",o="";t&&n&&(t=n.aggregate.result(t.get(f)),a=String(t),o=n.aggregate.format(t)),c.push({columnTuple:e,data:{fmtValue:o,ordinal:0,value:a},rowTuple:i})})}),c}},111:(e,i,r)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.cloneDataTree=i.createDataTree=i.mergeTrees=void 0;function v(a,o,i){a.forEach(function(e,r){var t,n;r!==i&&(0<e.size&&v(e,o,i),t=e.get(i),n=(0,_.subNode)(a,i,{}),o.forEach(function(e){e.aggregate.init(n),e.aggregate.merge(t,n)}))})}function A(t,n,a,o){t.forEach(function(e,r){r!==a&&(0<e.size&&A(e,n,a,o),r=(0,_.subNode)(e,a),e=(0,_.subNode)(t,a),(0,i.mergeTrees)(r,e,n,o))})}var n=r(429),_=r(238);i.mergeTrees=function(e,n,a,o){e.forEach(function(r,e){var t;e!==o?(t=(0,_.subNode)(n,e),(0,i.mergeTrees)(r,t,a,o)):(t=(0,_.subNode)(n,e,{}),a.forEach(function(e){e.aggregate.init(t),e.aggregate.merge(r,t)}))})};i.createDataTree=function(e,i,u,s,r,t){var l=new Map,c=new Map,f=i.concat(u),p=new Set,d=r.dataField,m=r.columnsData,r=(0,n.initializeFiltering)(i,u,t),g=r.hasFilter,h=r.predicate,y=r.filteringAxes;return e.forEach(function(r){if(g){var t={};if(y.forEach(function(e){t[e.key]=e.displayValue(r)}),!h(t))return}var n,e,a=f.map(function(e){return e.displayValue(r)}),a="".concat.apply("",a),o=c.get(a);o||(n=l,i.forEach(e=function(e){n=(0,_.subNode)(n,(0,_.createKey)(e.key,e.displayValue(r)))}),n=(0,_.subNode)(n,m),p.add(n),u.forEach(e),o={},n.set(d,o),c.set(a,o),s.forEach(function(e){e.aggregate.init(o)})),s.forEach(function(e){e.aggregate.accumulate(o,e.value(r))})}),p.forEach(function(e){return v(e,s,d)}),A(l,s,m,d),l},i.cloneDataTree=function(e,r,t){var n=new Map;return(0,i.mergeTrees)(e,n,t,r),n}},429:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.initializeFiltering=void 0;var i=t(48);function u(e,r){(Array.isArray(e)?e:e.filters).forEach(function(e){return function r(e,t){"filters"in e?e.filters.map(function(e){return r(e,t)}):t(e)}(e,r)})}r.initializeFiltering=function(e,r,t){var n,a=t?Array.isArray(t)?{logic:"and",filters:t}:t:void 0,a=a?(0,i.compileFilter)(a):function(){return!0},e=e.concat(r),o=[],r=(u(t||[],function(e){"field"in e&&e.field&&o.push(e.field)}),{hasFilter:!1,predicate:a,filteringAxes:[]});return o.some(function(e){return"function"==typeof e})?r.filteringAxes=e.slice():0<o.length&&(n=Array.from(new Set(o).values()),t=e.filter(function(e){return 0<=n.indexOf(e.key)}),r.filteringAxes=t),r.hasFilter=0<r.filteringAxes.length,r}},167:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0});var n=t(109);n.__exportStar(t(191),r),n.__exportStar(t(111),r),n.__exportStar(t(908),r),n.__exportStar(t(124),r),n.__exportStar(t(673),r),n.__exportStar(t(143),r)},143:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0})},673:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.createFlatSchemaDimensions=void 0,r.createFlatSchemaDimensions=function(e,r){e=Object.keys(e).map(function(e){return{caption:e,defaultHierarchy:e,description:"",name:e,uniqueName:e,hierarchyUniqueName:e,measure:!0,type:1}});return r.length&&e.push({caption:"Measures",children:r.map(function(e){return{aggregator:"1",caption:String(e.name),defaultFormat:"",description:"",displayFolder:"",groupName:String(e.name),name:String(e.name),uniqueName:String(e.name)}}),type:2,description:"",name:"Measures",uniqueName:"[Measures]"}),e}},124:(e,c,r)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.createLocalDataState=c.addMultipleMeasures=c.createTuples=c.rootFields=void 0;function f(e){return{caption:String(e.name),children:[],hasChildren:!1,hierarchy:"[Measures]",levelName:"[Measures].[MeasuresLevel]",levelNum:0,name:"[Measures].["+e.name+"]",parentName:""}}function u(e,r){return r=f(r),(e=(0,s.copy)(e)).members.push(r),e}var s=r(70),O=r(238),p=r(908),x=function(e,t,n){e.forEach(function(e,r){n[r]||(r=(0,O.subNode)(t,r),x(e,r,n))})};c.rootFields=function(e){var r=new Set;return e.forEach(function(e){1!==e.name.length||(0,O.splitKeyValue)(e.name[0])[1]||r.add(e.name[0])}),r},c.createTuples=function(v,r,A,_,E){var t,n,a=(0,c.rootFields)(r),N=[],e=(t=v,n={members:[]},a.forEach(function(r){var e=t.find(function(e){return e.key===r}),e=e?e.caption:"";n.members.push({caption:e,children:[],hasChildren:!0,parentName:"",levelNum:0,levelName:e,hierarchy:r,name:e})}),n);N.push(e);for(var o=0;o<r.length;o++)(e=>{var p=r[e];if(1===p.name.length&&!p.expand&&a.has(p.name[0]))return;var d,m=new Set(a.keys()),g=[],h=[],y=[];p.name.forEach(function(r,e){var n,a,t=(0,O.splitKeyValue)(r),o=t[0],t=t[1];if(d=v.find(function(e){return e.key===o}),t){m.delete(o),h.push(r);var i={children:[],caption:t,hierarchy:o,levelNum:1,levelName:o+" "+o,name:r,parentName:d?d.caption:""};g.push(i)}else if(p.expand&&p.name.length-1===e){m.delete(r),h.push(r);var u=((n,a)=>{for(var e,o=[],i=function(e){return Array.from(e).filter(function(e){return!a[e[0]]})},u=new Map(A),r=0;r<n.length;r++)(r=>{var t;(e=u.get(n[r]))?u=new Map(e):r<n.length-1&&Array.from(u).some(function(e){return(0,O.splitKeyValue)(e[0])[0]===n[r]})?(t=[],u.forEach(function(e,r){a[r]||t.push.apply(t,i(new Map(e)))}),u=new Map,t.forEach(function(e){var r,t,n;u.has(e[0])?(r=u.get(e[0]),t=e[1],n=new Map,x(r,n,a),x(t,n,a),u.set(e[0],n)):u.set(e[0],new Map(e[1]))})):0!==r&&r!==n.length-1||Array.from(u).some(function(e){return(0,O.splitKeyValue)(e[0])[0]===n[r]})&&o.push.apply(o,i(u))})(r);return o})(h,E),t=_.find(function(e){return e.field===o});t&&t.dir&&u.sort((n=t,a=d,function(e,r){var t=n.dir,e=a.sortValue((0,O.splitKeyValue)(e[0])[1]),r=a.sortValue((0,O.splitKeyValue)(r[0])[1]);return e<r?"asc"===t?-1:1:r<e?"asc"===t?1:-1:0}));for(var s=0;s<u.length;s++){var l=u[s][0],c={members:[]},f=(y.push(c),(0,O.splitKeyValue)(l)[1]);d=v.find(function(e){return e.key===r}),i={caption:f,children:[],levelName:r+" "+r,levelNum:1,parentName:d?d.caption:"",hierarchy:r,name:l},(f=c.members).push.apply(f,g),c.members.push(i)}}else p.expand&&(e=(d=v.find(function(e){return e.key===r}))?d.caption:"",m.delete(r),h.push(r),g.push(i={children:[],caption:e,hierarchy:r,levelName:e,levelNum:0,name:e,parentName:""}));m.forEach(function(t){y.forEach(function(e){var r=(d=v.find(function(e){return e.key===t}))?d.caption:"";e.members.push({children:[],hasChildren:!0,caption:r,hierarchy:t,levelName:r,levelNum:0,name:r,parentName:""})})}),N.push.apply(N,y)})})(o);return N};c.addMultipleMeasures=function(e,r){if(r.length<2)return e;for(var t=e.slice(),n=t.length-1;0<=n;n--){var a=t[n];t[n]=u(t[n],r[0]);for(var o=1;o<r.length;o++){var i=u(a,r[o]);t.splice(n+o,0,i)}}return(0,s.reverseColumnsByMeasures)(t)},c.createLocalDataState=function(e){var r,t=e.dataTree,n=e.rowSettings,a=e.columnSettings,o=e.rowAxes,i=e.columnAxes,u=e.measures,s=e.sort,e=e.fields,l=((r={})[e.columnsData]=e.columnsData,r[e.dataField]=e.dataField,i.length?(0,c.createTuples)(a,i,t.get(e.columnsData),s,r):u.map(function(e){return{members:[f(e)]}})),i=0<i.length?(0,c.addMultipleMeasures)(l,u):l,l=o.length?(0,c.createTuples)(n,o,t,s,r):[{members:[]}];return{columns:i,data:(0,p.readData)(t,l,i,e,a,n,u),rows:l}}},238:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.splitKeyValue=r.createKey=r.subNode=void 0,r.subNode=function(e,r,t){var n=e.get(r);return n||(n=t||new Map,e.set(r,n)),n},r.createKey=function(e,r){return e+"&"+r},r.splitKeyValue=function(e){var r=e.indexOf("&");return-1!==r?[e.substring(0,r),e.substring(r+1)]:[e,void 0]}},875:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ConfiguratorNavigation=r.PivotGridNavigation=r.HEADERS_ACTION=r.headersReducer=r.compareAxes=r.toData=r.toRows=r.toColumns=r.toTree=r.buildKPIMeasures=r.addKPI=r.parseResponse=r.setFilter=r.setSort=r.createAxisDescriptors=r.createDataState=r.discoverCommands=r.createDiscoverBody=r.fetchDiscover=r.fetchData=r.createRequestBody=void 0;var n=t(109),a=t(179),o=(Object.defineProperty(r,"createRequestBody",{enumerable:!0,get:function(){return a.createRequestBody}}),t(51)),i=(Object.defineProperty(r,"fetchData",{enumerable:!0,get:function(){return o.fetchData}}),Object.defineProperty(r,"fetchDiscover",{enumerable:!0,get:function(){return o.fetchDiscover}}),t(992)),u=(Object.defineProperty(r,"createDiscoverBody",{enumerable:!0,get:function(){return i.createDiscoverBody}}),Object.defineProperty(r,"discoverCommands",{enumerable:!0,get:function(){return i.discoverCommands}}),t(75)),s=(Object.defineProperty(r,"createDataState",{enumerable:!0,get:function(){return u.createDataState}}),t(644)),l=(Object.defineProperty(r,"createAxisDescriptors",{enumerable:!0,get:function(){return s.createAxisDescriptors}}),t(220)),c=(Object.defineProperty(r,"setSort",{enumerable:!0,get:function(){return l.setSort}}),t(658)),f=(Object.defineProperty(r,"setFilter",{enumerable:!0,get:function(){return c.setFilter}}),t(659)),p=(Object.defineProperty(r,"parseResponse",{enumerable:!0,get:function(){return f.parseResponse}}),t(70)),d=(Object.defineProperty(r,"addKPI",{enumerable:!0,get:function(){return p.addKPI}}),Object.defineProperty(r,"buildKPIMeasures",{enumerable:!0,get:function(){return p.buildKPIMeasures}}),Object.defineProperty(r,"toTree",{enumerable:!0,get:function(){return p.toTree}}),Object.defineProperty(r,"toColumns",{enumerable:!0,get:function(){return p.toColumns}}),Object.defineProperty(r,"toRows",{enumerable:!0,get:function(){return p.toRows}}),Object.defineProperty(r,"toData",{enumerable:!0,get:function(){return p.toData}}),Object.defineProperty(r,"compareAxes",{enumerable:!0,get:function(){return p.compareAxes}}),t(628)),m=(Object.defineProperty(r,"headersReducer",{enumerable:!0,get:function(){return d.headersReducer}}),Object.defineProperty(r,"HEADERS_ACTION",{enumerable:!0,get:function(){return d.HEADERS_ACTION}}),n.__exportStar(t(420),r),n.__exportStar(t(150),r),n.__exportStar(t(167),r),t(435));Object.defineProperty(r,"PivotGridNavigation",{enumerable:!0,get:function(){return m.PivotGridNavigation}}),Object.defineProperty(r,"ConfiguratorNavigation",{enumerable:!0,get:function(){return m.ConfiguratorNavigation}})},420:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0})},182:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ConfiguratorNavigation=void 0;function n(e,r,t,n){t.preventDefault(),t=r.elements,(n=t.indexOf(e)+n)<0&&(n=t.length-1),r.focusElement(t[n%t.length],e)}function a(e,r,t){t.target instanceof HTMLElement&&t.target.querySelector(".k-icon.k-i-x-circle, .k-svg-icon.k-svg-i-x-circle")instanceof HTMLElement&&(t.preventDefault(),n(e,r,t,-1))}var o,i=t(109),t=t(965),u=[".k-pivotgrid-configurator-content .k-form-field .k-fields-list-wrapper .k-treeview",".k-pivotgrid-configurator-content .k-chip",".k-pivotgrid-configurator-actions button"],s={keydown:{Tab:function(e,r,t){n(e,r,t,t.shiftKey?-1:1)},Escape:function(e,r,t){t.target instanceof HTMLElement&&r.root&&(t=r.root.previousElementSibling,r=r.root.nextElementSibling,(t=Array.from(t instanceof HTMLElement?t.querySelectorAll("[tabindex]"):[]).find(function(e){return 0<=e.tabIndex}))instanceof HTMLElement)&&(t.focus(),r instanceof HTMLElement)&&r.click()},Delete:a,Backspace:a}},l={click:function(e,r){var t;e&&e instanceof HTMLElement&&(t=r.elements.find(function(e){return e.hasAttribute("tabindex")})||null,r.focusElement(e,t))}},t=(o=t.Navigation,i.__extends(c,o),c);function c(){var e=null!==o&&o.apply(this,arguments)||this;return e.selectors=u,e.mouseEvents=l,e.keyboardEvents=s,e}r.ConfiguratorNavigation=t},435:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ConfiguratorNavigation=r.PivotGridNavigation=void 0;var n=t(175),a=(Object.defineProperty(r,"PivotGridNavigation",{enumerable:!0,get:function(){return n.PivotGridNavigation}}),t(182));Object.defineProperty(r,"ConfiguratorNavigation",{enumerable:!0,get:function(){return a.ConfiguratorNavigation}})},965:(e,r)=>{function t(e){this.tabIndex=0,this.root=null,this.eventHandlers={},this.update=function(){},this.tabIndex=e.tabIndex}Object.defineProperty(r,"__esModule",{value:!0}),r.Navigation=void 0,Object.defineProperty(t.prototype,"elements",{get:function(){return this.root?Array.from(this.root.querySelectorAll(this.selectors.join(","))):[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"first",{get:function(){return this.root&&this.root.querySelector(this.selectors.join(","))||null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"last",{get:function(){var e=this.elements;return e[e.length-1]||null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"current",{get:function(){return this.elements.find(function(e){return e.matches(":focus")})},enumerable:!1,configurable:!0}),t.prototype.start=function(e){var a=this,r=(this.root=e,this);for(t in this.mouseEvents)(t=>{r.mouseEvents[t]&&(r.eventHandlers[t]=function(e){var r=e.target instanceof Element&&e.target.closest(a.selectors.join(","));r&&a.mouseEvents[t].call(void 0,r,a,e)},e.addEventListener(t,r.eventHandlers[t]))})(t);var t,o=this;for(t in this.keyboardEvents)(n=>{o.keyboardEvents[n]&&(o.eventHandlers[n]=function(e){var r=e.target instanceof Element&&e.target.closest(a.selectors.join(",")),t=" "===e.key?"Space":e.key;r&&a.keyboardEvents[n][t]&&a.keyboardEvents[n][t].call(void 0,r,a,e)},e.addEventListener(n,o.eventHandlers[n]))})(t)},t.prototype.stop=function(){if(this.root)for(var e in this.eventHandlers)this.eventHandlers[e]&&this.root.removeEventListener(e,this.eventHandlers[e]);this.root=null},t.prototype.focusElement=function(e,r){e&&(r&&(r.removeAttribute("tabindex"),r.classList.remove("k-focus")),e.setAttribute("tabindex",String(this.tabIndex)),e.focus({preventScroll:!0}))},r.Navigation=t},175:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PivotGridNavigation=void 0;function n(e,r,t){var n,a=e.querySelector(".k-icon, .k-svg-icon");a&&(n=r.elements.indexOf(e),r.update=function(){r.focusElement(r.elements[n],null),r.update=function(){}},a.click(),t.preventDefault())}function a(e,r,t){e.offsetLeft<r.scrollLeft&&(t.scrollLeft=e.offsetLeft)}function o(e,r,t){e.offsetLeft+e.offsetWidth>r.scrollLeft+r.offsetWidth&&e.offsetWidth<r.offsetWidth&&(t.scrollLeft=e.offsetLeft+e.offsetWidth-r.offsetWidth)}function i(e,r,t){r.scrollTop&&e.offsetTop<r.scrollTop&&(t.scrollTop=e.offsetTop)}function u(e,r,t){e.offsetTop+e.offsetHeight>r.scrollTop+r.offsetHeight&&e.offsetHeight<r.offsetHeight&&(t.scrollTop=e.offsetTop+e.offsetHeight-r.offsetHeight)}function s(r,e,t){var n=e.querySelector(m),a=r&&r.closest(_);n&&a&&r&&t.forEach(function(e){return e(r,a,n)})}function l(e){for(var r=N(e.querySelector([g,v].join(" "))),t=N(e.querySelector([h,v].join(" "))),n=N(e.querySelector([m,v].join(" "))),e=e.querySelector(y),a=new Array(t[0].length).fill(e),o=[],i=0;i<r.length;i++)o.push(a.concat(r[i]));for(i=0;i<t.length;i++)o.push(t[i].concat(n[i]));return o}function c(e){return e.ctrlKey||e.metaKey}function f(e,r,t){for(var n=l(e),a=[(e=((e,r)=>{for(var t=0;t<e.length;t++)for(var n=0;n<e[t].length;n++)if(e[t][n]===r)return[t,n];return[-1,-1]})(n,r))[0]+t[0],e[1]+t[1]],o=n[a[0]]&&n[a[0]][a[1]];o&&o===r;)o=n[(a=[a[0]+t[0],a[1]+t[1]])[0]]&&n[a[0]][a[1]];return o}var p,d=t(109),t=t(965),m=".k-pivotgrid .k-pivotgrid-values",g=".k-pivotgrid .k-pivotgrid-column-headers",h=".k-pivotgrid .k-pivotgrid-row-headers",y=".k-pivotgrid > .k-pivotgrid-empty-cell",v="table.k-pivotgrid-table",A=".k-pivotgrid-cell",_=[m,g,h].join(","),E=[y,[g,v,A].join(" "),[h,v,A].join(" "),[m,v,A].join(" ")],N=function(e){var e=Array.from(e.rows),r=Array.from(e&&e[0]&&e[0].cells||[]).map(function(e){return e.colSpan}).reduce(function(e,r){return e+r},0),i=e.map(function(){return new Array(r)});return e.forEach(function(e,a){var o=0;Array.from(e.cells).forEach(function(e){for(var r=0;r<e.colSpan;r++){for(var t=0;t<e.rowSpan;t++){var n=i[a+t].findIndex(function(e,r){return o<=r&&!e});i[a+t][n]=e}o++}})}),i},O={keydown:{ArrowLeft:function(e,r,t){t.preventDefault();t=f(r.root,e,[0,-1]);r.focusElement(t,e),s(t,r.root,[o,a,u,i])},ArrowRight:function(e,r,t){t.preventDefault();t=f(r.root,e,[0,1]);r.focusElement(t,e),s(t,r.root,[a,o,u,i])},ArrowUp:function(e,r,t){t.preventDefault();t=f(r.root,e,[-1,0]);r.focusElement(t,e),s(t,r.root,[o,a,u,i])},ArrowDown:function(e,r,t){t.preventDefault();t=f(r.root,e,[1,0]);r.focusElement(t,e),s(t,r.root,[o,a,i,u])},o:function(e,r,t){var n;r.root&&(n=r.root.nextElementSibling)&&n instanceof HTMLElement&&n.matches("div.k-pivotgrid-configurator-button")&&(n.click(),setTimeout(function(){var e;r.root.parentNode&&(e=r.root.parentNode.querySelector(".k-pivotgrid-configurator-content .k-form-field .k-fields-list-wrapper .k-treeview"))instanceof HTMLElement&&(e.setAttribute("tabindex",String(r.tabIndex)),e.focus())},0))},Enter:n,Space:n,Home:function(r,e,t){var n=l(e.root),n=(c(t)?n[0]:n.find(function(e){return Boolean(e.find(function(e){return e===r}))})||[])[0];n&&(e.focusElement(n,r),s(n,e.root,[o,a,u,i]),t.preventDefault())},End:function(r,e,t){var n=l(e.root),n=c(t)?n[n.length-1]:n.find(function(e){return Boolean(e.find(function(e){return e===r}))})||[],n=n&&n[n.length-1]||null;n&&(e.focusElement(n,r),s(n,e.root,[a,o,i,u]),t.preventDefault())}}},x={click:function(e,r){var t;e&&e instanceof HTMLElement&&(t=r.elements.find(function(e){return e.hasAttribute("tabindex")})||null,r.focusElement(e,t))}},A=(p=t.Navigation,d.__extends(I,p),I);function I(){var e=null!==p&&p.apply(this,arguments)||this;return e.selectors=E,e.mouseEvents=x,e.keyboardEvents=O,e}r.PivotGridNavigation=A},150:(e,h,r)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.configuratorReducer=h.PIVOT_CONFIGURATOR_ACTION=void 0;var y,v=r(109),A=r(70);(r=y||(h.PIVOT_CONFIGURATOR_ACTION=y={})).toggleSelection="PIVOT_CONFIGURATOR_ACTION_TOGGLE_SELECTION",r.addColumnAxis="PIVOT_CONFIGURATOR_ACTION_ADD_COLUMN_AXIS",r.addColumnAxes="PIVOT_CONFIGURATOR_ACTION_ADD_COLUMN_AXES",r.removeColumnAxis="PIVOT_CONFIGURATOR_ACTION_REMOVE_COLUMN_AXIS",r.removeColumnAxes="PIVOT_CONFIGURATOR_ACTION_REMOVE_COLUMN_AXES",r.addRowAxis="PIVOT_CONFIGURATOR_ACTION_ADD_ROW_AXIS",r.addRowAxes="PIVOT_CONFIGURATOR_ACTION_ADD_ROW_AXES",r.removeRowAxis="PIVOT_CONFIGURATOR_ACTION_REMOVE_ROW_AXIS",r.removeRowAxes="PIVOT_CONFIGURATOR_ACTION_REMOVE_ROW_AXES",r.addMeasureAxis="PIVOT_CONFIGURATOR_ACTION_ADD_MEASURE_AXIS",r.addMeasureAxes="PIVOT_CONFIGURATOR_ACTION_ADD_MEASURE_AXES",r.removeMeasureAxis="PIVOT_CONFIGURATOR_ACTION_REMOVE_MEASURE_AXIS",r.removeMeasureAxes="PIVOT_CONFIGURATOR_ACTION_REMOVE_MEASURE_AXES",r.remove="PIVOT_CONFIGURATOR_ACTION_REMOVE",r.setSort="PIVOT_CONFIGURATOR_ACTION_SET_SORT",r.setFilter="PIVOT_CONFIGURATOR_ACTION_SET_FILTER",r.addFilter="PIVOT_CONFIGURATOR_ACTION_ADD_FILTER",r.changeFilter="PIVOT_CONFIGURATOR_ACTION_CHANGE_FILTER",r.removeFilter="PIVOT_CONFIGURATOR_ACTION_REMOVE_FILTER",r.setDragItem="PIVOT_CONFIGURATOR_ACTION_SET_DRAGITEM",r.drop="PIVOT_CONFIGURATOR_ACTION_DROP",r.setDropZone="PIVOT_CONFIGURATOR_ACTION_SET_DROP_ZONE",r.setDropTarget="PIVOT_CONFIGURATOR_ACTION_SET_DROP_TARGET",r.setDropDirection="PIVOT_CONFIGURATOR_ACTION_SET_DROP_DIRECTION",h.configuratorReducer=function(e,t){var r,n,a,o,i,u,s,l,c,f;switch(t.type){case y.toggleSelection:if(Array.isArray(t.payload))break;return 2===(f=t.payload).type||"aggregator"in f?e.measureAxes.some(function(e){return(0,A.compareAxisWithField)(e,f)})?(0,h.configuratorReducer)(e,v.__assign(v.__assign({},t),{type:y.removeMeasureAxis})):(0,h.configuratorReducer)(e,v.__assign(v.__assign({},t),{type:y.addMeasureAxis})):"kpi"===f.type?(p=(0,A.buildKPIMeasures)(f)).every(function(r){return e.measureAxes.some(function(e){return(0,A.compareAxisWithField)(e,r)})})?(0,h.configuratorReducer)(e,v.__assign(v.__assign({},t),{type:y.removeMeasureAxes,payload:p})):(0,h.configuratorReducer)(e,v.__assign(v.__assign({},t),{type:y.addMeasureAxes,payload:p.filter(function(r){return!e.measureAxes.some(function(e){return(0,A.compareAxisWithField)(e,r)})})})):t.payload.kpi?e.measureAxes.some(function(e){return(0,A.compareAxisWithField)(e,f)})?(0,h.configuratorReducer)(e,v.__assign(v.__assign({},t),{type:y.removeMeasureAxis})):(0,h.configuratorReducer)(e,v.__assign(v.__assign({},t),{type:y.addMeasureAxis})):e.columnAxes.some(function(e){return(0,A.compareAxisWithField)(e,f)})?(0,h.configuratorReducer)(e,v.__assign(v.__assign({},t),{type:y.removeColumnAxis})):e.rowAxes.some(function(e){return(0,A.compareAxisWithField)(e,f)})?(0,h.configuratorReducer)(e,v.__assign(v.__assign({},t),{type:y.removeRowAxis})):!e.columnAxes||!e.columnAxes.length||e.rowAxes&&e.rowAxes.length?(0,h.configuratorReducer)(e,v.__assign(v.__assign({},t),{type:y.addColumnAxis})):(0,h.configuratorReducer)(e,v.__assign(v.__assign({},t),{type:y.addRowAxis}));case y.addColumnAxis:n=v.__spreadArray(v.__spreadArray([],e.columnAxes||[],!0),[{name:[t.payload.defaultHierarchy||t.payload.uniqueName]}],!1);break;case y.addColumnAxes:break;case y.removeColumnAxis:n=v.__spreadArray([],(e.columnAxes||[]).filter(function(e){return!(0,A.compareAxisWithField)(e,t.payload)}),!0),(0,A.filterField)(n,t.payload);break;case y.removeColumnAxes:break;case y.addRowAxis:r=v.__spreadArray(v.__spreadArray([],e.rowAxes||[],!0),[{name:[t.payload.defaultHierarchy||t.payload.uniqueName]}],!1);break;case y.addRowAxes:break;case y.removeRowAxis:r=v.__spreadArray([],(e.rowAxes||[]).filter(function(e){return!(0,A.compareAxisWithField)(e,t.payload)}),!0),(0,A.filterField)(r,t.payload);break;case y.removeRowAxes:break;case y.addMeasureAxis:a=v.__spreadArray(v.__spreadArray([],e.measureAxes||[],!0),[{name:[t.payload.defaultHierarchy||t.payload.uniqueName]}],!1);break;case y.removeMeasureAxis:a=v.__spreadArray([],(e.measureAxes||[]).filter(function(e){return!(0,A.compareAxisWithField)(e,t.payload)}),!0);break;case y.addMeasureAxes:a=v.__spreadArray(v.__spreadArray([],e.measureAxes||[],!0),(t.payload||[]).map(function(e){return{name:[e.defaultHierarchy||e.uniqueName]}}),!0);break;case y.removeMeasureAxes:a=v.__spreadArray([],(e.measureAxes||[]).filter(function(r){return!t.payload.some(function(e){return(0,A.compareAxisWithField)(r,e)})}),!0);break;case y.remove:e.columnAxes.some(function(e){return(0,A.compareAxes)(e,t.payload)})&&(n=v.__spreadArray([],e.columnAxes.filter(function(e){return!(0,A.compareAxes)(e,t.payload)}),!0),(0,A.filterField)(n,{uniqueName:t.payload.name})),e.rowAxes.some(function(e){return(0,A.compareAxes)(e,t.payload)})&&(r=v.__spreadArray([],e.rowAxes.filter(function(e){return!(0,A.compareAxes)(e,t.payload)}),!0),(0,A.filterField)(r,{uniqueName:t.payload.name})),e.measureAxes.some(function(e){return(0,A.compareAxes)(e,t.payload)})&&(a=v.__spreadArray([],e.measureAxes.filter(function(e){return!(0,A.compareAxes)(e,t.payload)}),!0));break;case y.setDragItem:u=t.payload;break;case y.setDropZone:s=t.payload;break;case y.setDropTarget:c=t.payload;break;case y.setDropDirection:l=t.payload;break;case y.drop:if(e.dragItem&&e.dropZone){var p=e.columnAxes.find(function(e){return(0,A.compareAxes)(e,t.payload)}),d=e.rowAxes.find(function(e){return(0,A.compareAxes)(e,t.payload)}),m=e.measureAxes.find(function(e){return(0,A.compareAxes)(e,t.payload)}),g=void 0;switch(p&&(g=p,n=v.__spreadArray([],e.columnAxes.filter(function(e){return!(0,A.compareAxes)(e,t.payload)}),!0),(0,A.filterField)(n,{uniqueName:t.payload.name})),d&&(g=d,r=v.__spreadArray([],e.rowAxes.filter(function(e){return!(0,A.compareAxes)(e,t.payload)}),!0),(0,A.filterField)(r,{uniqueName:t.payload.name})),m&&(g=m,a=v.__spreadArray([],e.measureAxes.filter(function(e){return!(0,A.compareAxes)(e,t.payload)}),!0)),e.dropZone){case"columnAxes":n=n||e.columnAxes.slice(),(0,A.insertAxis)(n,g,e);break;case"rowAxes":r=r||e.rowAxes.slice(),(0,A.insertAxis)(r,g,e);break;case"measureAxes":a=a||e.measureAxes.slice(),(0,A.insertAxis)(a,g,e)}}c=s=u=null;break;case y.setSort:o=t.payload;break;case y.setFilter:i=Array.isArray(t.payload)?t.payload:[t.payload];break;case y.addFilter:i=(e.filter||[]).slice(),Array.isArray(t.payload)?i.push.apply(i,t.payload):i.push(t.payload);break;case y.changeFilter:i=Array.isArray(t.payload)?(e.filter||[]).map(function(r){return t.payload.some(function(e){return e.field===r.field})?t.payload.find(function(e){return e.field===r.field}):r}):(e.filter||[]).map(function(e){return e.field===t.payload.field?t.payload:e});break;case y.removeFilter:i=(e.filter||[]).slice(),i=Array.isArray(t.payload)?i.filter(function(r){return!t.payload.some(function(e){return e.field===r.field&&e.operator===r.operator})}):i.filter(function(e){return!(e.field===t.payload.field&&e.operator===t.payload.operator)})}return{dragItem:u,dropTarget:c,dropDirection:l,dropZone:s,columnAxes:n,rowAxes:r,measureAxes:a,filter:i,sort:o}}},560:(e,o,r)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.headersReducer=o.HEADERS_ACTION=void 0;function i(e,t,n){var a=new Set;return e.children.forEach(function(e){var r=t(e);n&&a.add(String(e.path)),i(e,t,n||r).map(function(e){a.add(e)})}),Array.from(a.values())}var u,s=r(109);(r=u||(o.HEADERS_ACTION=u={})).toggle="HEADERS_ACTION_TOGGLE",r.expand="HEADERS_ACTION_EXPAND",r.collapse="HEADERS_ACTION_COLLAPSE";o.headersReducer=function(e,r){switch(r.type){case u.toggle:var t=e.find(function(e){return String(e.name)===String(r.payload)});return(0,o.headersReducer)(e,s.__assign(s.__assign({},r),{type:t&&t.expand?u.collapse:u.expand}));case u.expand:var n=e.find(function(e){return String(e.name)===String(r.payload)});return n&&!0===n.expand?e:!n||!1!==n.expand&&void 0!==n.expand?((t=e.slice()).push({name:r.payload,expand:!0}),t):e.map(function(e){return e===n?s.__assign(s.__assign({},n),{expand:!0}):e});case u.collapse:var a=i(r.tree,function(e){return!e.total&&String(e.path)===String(r.payload)});return e.slice().filter(function(r){return!a.some(function(e){return e===String(r.name)})}).map(function(e){return s.__assign(s.__assign({},e),{expand:Boolean(e.expand)})}).map(function(e){return String(e.name)===String(r.payload)?1<r.payload.length?void 0:{name:r.payload,expand:!1}:e}).filter(Boolean);default:return e}}},628:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0});var n=t(109);n.__exportStar(t(560),r),n.__exportStar(t(150),r)},992:(e,n)=>{function a(e,r,t){var n="";if(r){n+="<"+e+">";var a,o;for(o in r)r[o]&&(a=r[o],t&&(o=o.replace(/([A-Z]+(?=$|[A-Z][a-z])|[A-Z]?[a-z]+)/g,"$1_").toUpperCase().replace(/_$/,"")),n+="<"+o+">"+a+"</"+o+">");n+="</"+e+">"}else n+="<"+e+"/>";return n}Object.defineProperty(n,"__esModule",{value:!0}),n.discoverCommands=void 0,n.createDiscoverBody=function(e){var r={},t='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis">',t=(t+="<RequestType>"+(n.discoverCommands[e.command]||e.command)+"</RequestType>")+("<Restrictions>"+a("RestrictionList",e.restrictions,!0)+"</Restrictions>");return e.connection&&e.connection.catalog&&(r.Catalog=e.connection.catalog),t+("<Properties>"+a("PropertyList",r,!1))+"</Properties></Discover></Body></Envelope>"},n.discoverCommands={schemaCatalogs:"DBSCHEMA_CATALOGS",schemaCubes:"MDSCHEMA_CUBES",schemaDimensions:"MDSCHEMA_DIMENSIONS",schemaHierarchies:"MDSCHEMA_HIERARCHIES",schemaKPIs:"MDSCHEMA_KPIS",schemaLevels:"MDSCHEMA_LEVELS",schemaMeasures:"MDSCHEMA_MEASURES",schemaMembers:"MDSCHEMA_MEMBERS"}},51:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.fetchDiscover=r.fetchData=void 0;var a=t(109),o=t(179),i=t(659),u=t(992),t=t(379),s={schemaCatalogs:t.parseCatalogs,schemaCubes:t.parseCubes,schemaDimensions:t.parseDimensions,schemaHierarchies:t.parseHierarchies,schemaKPIs:t.parseKPIs,schemaLevels:t.parseLevels,schemaMeasures:t.parseMeasures,schemaMembers:t.parseMembers};r.fetchData=function(t,n){return a.__awaiter(void 0,void 0,void 0,function(){var r;return a.__generator(this,function(e){switch(e.label){case 0:return r=a.__assign({body:(0,o.createRequestBody)(n),headers:{"Content-Type":"text/xml"},method:"POST"},t.init),[4,fetch(t.url,r)];case 1:return[4,e.sent().text()];case 2:return r=e.sent(),[2,(0,i.parseResponse)(r)]}})})},r.fetchDiscover=function(t,n){return a.__awaiter(void 0,void 0,void 0,function(){var r;return a.__generator(this,function(e){switch(e.label){case 0:return r=a.__assign({body:(0,u.createDiscoverBody)(n),headers:{"Content-Type":"text/xml"},method:"POST"},t.init),[4,fetch(t.url,r)];case 1:return[4,e.sent().text()];case 2:return r=e.sent(),[2,s[n.command](r)]}})})}},179:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.createRequestBody=function(e){var r='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Execute xmlns="urn:schemas-microsoft-com:xml-analysis"><Command><Statement>',t=e.columnAxes,t=void 0===t?[]:t,n=e.rowAxes,n=void 0===n?[]:n,a=e.measureAxes,a=void 0===a?[]:a,o=e.sort,o=void 0===o?[]:o,i=e.filter,i=void 0===i?[]:i,u="rows"===e.measuresAxis;return r+="SELECT NON EMPTY {",t.length||!n.length||a.length&&(a.length,!u)||(t=n,u=!(n=[])),t.length||n.length||(u=!1),t.length?r+=(0,l.serializeMembers)(t,u?[]:a,o):a.length&&!u&&(r+=(0,l.measureNames)(a).join(",")),r+="} DIMENSION PROPERTIES CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME ON COLUMNS",(n.length||u&&1<a.length)&&(r+=", NON EMPTY {",n.length?r+=(0,l.serializeMembers)(n,u?a:[],o):r+=(0,l.measureNames)(a).join(","),r+="} DIMENSION PROPERTIES CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME ON ROWS"),i.length?r=(r=r+" FROM "+"(")+(0,s.serializeFilters)(i,e.connection.cube)+")":r+=" FROM ["+e.connection.cube+"]",(r+="</Statement></Command><Properties><PropertyList><Catalog>"+e.connection.catalog+"</Catalog><Format>Multidimensional</Format></PropertyList></Properties></Execute></Body></Envelope>").replace(/&/g,"&amp;")};var s=t(574),l=t(694)},574:(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.serializeFilters=function(e,r){for(var t,n,a,o,i="",u="",s=e.length-1;0<=s;s--)u=(u="SELECT (")+(t=e[s],o=a=n=void 0,n="",a=String(t.value),o=t.field,n=(t=t.operator)===c.in?(n+="{")+a+"}":(n=(n+=t===c.neq||t===c.doesnotcontain?"-":"")+"Filter("+o+".MEMBERS")+function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return e.forEach(function(e,r){t=t.replace(new RegExp("\\{".concat(r,"\\}"),"g"),e)}),t}(l[t],o,a)+")")+") ON 0",i=s===e.length-1?u+=" FROM ["+r+"]":u+" FROM ( "+i+" )";return i};var l={contains:', InStr({0}.CurrentMember.MEMBER_CAPTION,"{1}") > 0',doesnotcontain:', InStr({0}.CurrentMember.MEMBER_CAPTION,"{1}")',endswith:', Right({0}.CurrentMember.MEMBER_CAPTION,Len("{1}"))="{1}"',eq:', {0}.CurrentMember.MEMBER_CAPTION = "{1}"',neq:', {0}.CurrentMember.MEMBER_CAPTION = "{1}"',startswith:', Left({0}.CurrentMember.MEMBER_CAPTION,Len("{1}"))="{1}"'},c={doesnotcontain:"doesnotcontain",in:"in",neq:"neq"}},694:(e,r)=>{function t(e){for(var r,t=e.length,n=[],a=0;a<t;a++)r=e[a],n.push(void 0!==r.name?r.name:r);return n}function p(e,r){e=e.slice(0);return 0<r.length&&e.push("{"+t(r).join(",")+"}"),function e(r){var t,n="CROSSJOIN({";return 2<r.length?(t=r.pop(),n+=e(r)):(n+=r.shift(),t=r.pop()),n+="},{",(n+=t)+"})"}(e)}function d(e,r){var t=e.length-1,n=e[t],r=((e,r)=>{for(var t=0,n=e.length;t<n;t++)if(0===r.indexOf(e[t].field))return e[t];return null})(r,n);return r&&r.dir?n="ORDER("+n+".Children,"+r.field+".CurrentMember.MEMBER_CAPTION,"+r.dir+")":n+=".Children",e[t]=n,e}function m(e){var r=e.split(".");return 2<r.length?r[0]+"."+r[1]:e}Object.defineProperty(r,"__esModule",{value:!0}),r.serializeMembers=function(e,r,t){var n,a,o="",e=(e=>{for(var r=[],t=[],n=[],a=0;a<e.length;a++){var o=e[a],i=o.name,u=!1;if(1<i.length)t.push(o);else{for(var s=m(i[0]),l=0,c=n.length;l<c;l++)if(0===n[l].name[0].indexOf(s)){u=!0;break}u||n.push(o),o.expand&&r.push(o)}}return{expanded:r=r.concat(t),root:n}})(e=e||[]),i=e.expanded,u=(a=[],e.root.forEach(function(e){var e=e.name[0],r=m(e);a.some(function(e){return 0===e.indexOf(r)})||a.push(e)}),a),s=[],l=i.length,c=0,f=[];if(1<u.length||0<r.length){for(s.push(p(u,r));c<l;c++)f=((e,r)=>{var t=r.length;r=r.slice(0);for(var n=0;n<e.length;n++)for(var a=e[n],o=0;o<t;o++){var i=m(r[o]);if(-1!==a.indexOf(i)){r[o]=a;break}}return r})(n=d(i[c].name,t),u),s.push(p(f,r));o+=s.join(",")}else{for(;c<l;c++)n=d(i[c].name,t),f.push(n[0]);o+=u.concat(f).join(",")}return o},r.measureNames=t},379:(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.parseCubes=function(e){e=(new DOMParser).parseFromString(e,"text/xml");return Array.from(e.querySelectorAll("DiscoverResponse > return > root > row")).map(function(e){return{name:(0,n.getPropertyValue)(e,"CUBE_NAME"),caption:(0,n.getPropertyValue)(e,"CUBE_CAPTION"),description:(0,n.getPropertyValue)(e,"DESCRIPTION"),type:(0,n.getPropertyValue)(e,"CUBE_TYPE")}})},r.parseCatalogs=function(e){e=(new DOMParser).parseFromString(e,"text/xml");return Array.from(e.querySelectorAll("DiscoverResponse > return > root > row")).map(function(e){return{name:(0,n.getPropertyValue)(e,"CATALOG_NAME"),description:(0,n.getPropertyValue)(e,"DESCRIPTION")}})},r.parseMeasures=function(e){e=(new DOMParser).parseFromString(e,"text/xml");return Array.from(e.querySelectorAll("DiscoverResponse > return > root > row")).map(function(e){return{name:(0,n.getPropertyValue)(e,"MEASURE_NAME"),caption:(0,n.getPropertyValue)(e,"MEASURE_CAPTION"),uniqueName:(0,n.getPropertyValue)(e,"MEASURE_UNIQUE_NAME"),description:(0,n.getPropertyValue)(e,"DESCRIPTION"),aggregator:(0,n.getPropertyValue)(e,"MEASURE_AGGREGATOR"),groupName:(0,n.getPropertyValue)(e,"MEASUREGROUP_NAME"),displayFolder:(0,n.getPropertyValue)(e,"MEASURE_DISPLAY_FOLDER"),defaultFormat:(0,n.getPropertyValue)(e,"DEFAULT_FORMAT_STRING")}})},r.parseKPIs=function(e){e=(new DOMParser).parseFromString(e,"text/xml");return Array.from(e.querySelectorAll("DiscoverResponse > return > root > row")).map(function(e){return{name:(0,n.getPropertyValue)(e,"KPI_NAME"),uniqueName:(0,n.getPropertyValue)(e,"KPI_NAME"),caption:(0,n.getPropertyValue)(e,"KPI_CAPTION"),value:(0,n.getPropertyValue)(e,"KPI_VALUE"),goal:(0,n.getPropertyValue)(e,"KPI_GOAL"),status:(0,n.getPropertyValue)(e,"KPI_STATUS"),trend:(0,n.getPropertyValue)(e,"KPI_TREND"),statusGraphic:(0,n.getPropertyValue)(e,"KPI_STATUS_GRAPHIC"),trendGraphic:(0,n.getPropertyValue)(e,"KPI_TREND_GRAPHIC"),description:(0,n.getPropertyValue)(e,"KPI_DESCRIPTION"),groupName:(0,n.getPropertyValue)(e,"MEASUREGROUP_NAME"),type:"kpi"}})},r.parseDimensions=function(e){e=(new DOMParser).parseFromString(e,"text/xml");return Array.from(e.querySelectorAll("DiscoverResponse > return > root > row")).map(function(e){return{caption:(0,n.getPropertyValue)(e,"DIMENSION_CAPTION"),defaultHierarchy:(0,n.getPropertyValue)(e,"DEFAULT_HIERARCHY"),description:(0,n.getPropertyValue)(e,"DESCRIPTION"),name:(0,n.getPropertyValue)(e,"DIMENSION_NAME"),type:parseInt((0,n.getPropertyValue)(e,"DIMENSION_TYPE"),10),uniqueName:(0,n.getPropertyValue)(e,"DIMENSION_UNIQUE_NAME")}})},r.parseHierarchies=function(e){e=(new DOMParser).parseFromString(e,"text/xml");return Array.from(e.querySelectorAll("DiscoverResponse > return > root > row")).map(function(e){return{name:(0,n.getPropertyValue)(e,"HIERARCHY_NAME"),caption:(0,n.getPropertyValue)(e,"HIERARCHY_CAPTION"),description:(0,n.getPropertyValue)(e,"DESCRIPTION"),uniqueName:(0,n.getPropertyValue)(e,"HIERARCHY_UNIQUE_NAME"),dimensionUniqueName:(0,n.getPropertyValue)(e,"DIMENSION_UNIQUE_NAME"),displayFolder:(0,n.getPropertyValue)(e,"HIERARCHY_DISPLAY_FOLDER"),origin:(0,n.getPropertyValue)(e,"HIERARCHY_ORIGIN"),defaultMember:(0,n.getPropertyValue)(e,"DEFAULT_MEMBER")}})},r.parseLevels=function(e){e=(new DOMParser).parseFromString(e,"text/xml");return Array.from(e.querySelectorAll("DiscoverResponse > return > root > row")).map(function(e){return{name:(0,n.getPropertyValue)(e,"LEVEL_NAME"),caption:(0,n.getPropertyValue)(e,"LEVEL_CAPTION"),description:(0,n.getPropertyValue)(e,"DESCRIPTION"),uniqueName:(0,n.getPropertyValue)(e,"LEVEL_UNIQUE_NAME"),dimensionUniqueName:(0,n.getPropertyValue)(e,"DIMENSION_UNIQUE_NAME"),displayFolder:(0,n.getPropertyValue)(e,"LEVEL_DISPLAY_FOLDER"),orderingProperty:(0,n.getPropertyValue)(e,"LEVEL_ORDERING_PROPERTY"),origin:(0,n.getPropertyValue)(e,"LEVEL_ORIGIN"),hierarchyUniqueName:(0,n.getPropertyValue)(e,"HIERARCHY_UNIQUE_NAME")}})},r.parseMembers=function(e){e=(new DOMParser).parseFromString(e,"text/xml");return Array.from(e.querySelectorAll("DiscoverResponse > return > root > row")).map(function(e){return{name:(0,n.getPropertyValue)(e,"MEMBER_NAME"),caption:(0,n.getPropertyValue)(e,"MEMBER_CAPTION"),uniqueName:(0,n.getPropertyValue)(e,"MEMBER_UNIQUE_NAME"),dimensionUniqueName:(0,n.getPropertyValue)(e,"DIMENSION_UNIQUE_NAME"),hierarchyUniqueName:(0,n.getPropertyValue)(e,"HIERARCHY_UNIQUE_NAME"),levelUniqueName:(0,n.getPropertyValue)(e,"LEVEL_UNIQUE_NAME"),childrenCardinality:(0,n.getPropertyValue)(e,"CHILDREN_CARDINALITY")}})};var n=t(659)},659:(e,r)=>{function u(e,r){e=e.querySelector(r);return e?e.textContent:""}Object.defineProperty(r,"__esModule",{value:!0}),r.parseResponse=function(e){var e=(new DOMParser).parseFromString(e,"text/xml"),r=Array.from(e.querySelectorAll("Axis")),e=Array.from(e.querySelectorAll("CellData > Cell")).map(function(e){return{fmtValue:u(e,"FmtValue"),ordinal:parseInt(e.getAttribute("CellOrdinal"),10),value:u(e,"Value")}}),t={tuples:[]},n={tuples:[]},a=[],o=(r.forEach(function(e){var r;"SlicerAxis"!==e.getAttribute("name")&&(r=(0===t.tuples.length?t:n).tuples,Array.prototype.push.apply(r,Array.from(e.querySelectorAll("Tuple")).map(function(e){return{members:Array.from(e.querySelectorAll("Member")).map(function(e){var r=parseInt(u(e,"LNum")||"0",10),t=0<parseInt(u(e,"CHILDREN_CARDINALITY")||"0",10);return{caption:u(e,"Caption"),children:[],hasChildren:t,hierarchy:e.getAttribute("Hierarchy"),levelName:u(e,"LName"),levelNum:r,name:u(e,"UName"),parentName:u(e,"PARENT_UNIQUE_NAME")}})}})))}),new Array(n.tuples.length*t.tuples.length).fill(null)),i=(e.forEach(function(e){o[e.ordinal]=e}),0);return n.tuples.forEach(function(r){t.tuples.forEach(function(e){a.push({columnTuple:e,data:o[i],rowTuple:r}),i++})}),{columns:t,data:a,rows:n}},r.getPropertyValue=u},70:(e,y,r)=>{Object.defineProperty(y,"__esModule",{value:!0}),y.reverseColumnsByMeasures=y.insertAxis=y.filterField=y.compareAxes=y.compareAxisWithField=y.addKPI=y.cloneDate=y.toRows=y.toColumns=y.toData=y.toTree=y.toMatrix=y.generatePath=y.generateNormalizedPath=y.getMaxExpansion=y.getMaxNesting=void 0,y.clone=function(e){var r={};return t(e,r),r},y.cloneObject=t,y.cloneValue=a,y.copy=l,y.cloneArray=n,y.buildKPIMeasures=function(e){var r=e.name;return[o(r,e.value,"value"),o(r,e.goal,"goal"),o(r,e.status,"status"),o(r,e.trend,"trend")]};function u(e){return"[Measures]"===e.hierarchy}function s(e,r,t){void 0===r&&(r=null),void 0===t&&(t=0);for(var n,a=h.__assign(h.__assign({},e),{total:!0,hasChildren:!1,children:[]}),o=0;o<e.children.length;o++){var i=s(e.children[o],e,o),u=u||i.hierarchy;i.hierarchy===u||!r||r.children.some(function(e){return e.total&&e.name===a.name})||e.total||(a.children.push(i),e.children.splice(o,1),o--)}return 1<=e.children.filter(function(e){return!e.total}).length&&r&&!r.children.some(function(e){return e.total&&e.name===a.name})&&!e.total&&(n=e.children[0].hierarchy,e.hierarchy===n)&&r.children.splice(t+1,0,a),e}var h=r(109);y.getMaxNesting=function(e,r){return void 0===r&&(r=new Set),(e.children||[]).forEach(function(e){r.add(e.levelName),(0,y.getMaxNesting)(e,r)}),r.size},y.getMaxExpansion=function(e){var r=0;return(e.children||[]).forEach(function(e){r+=(0,y.getMaxExpansion)(e)||1}),r},y.generateNormalizedPath=function(e,r){return(r&&r.hierarchy===e.hierarchy?h.__spreadArray(h.__spreadArray([],(r.normalizedPath||[]).slice(0,-1),!0),[e.name||null],!1):h.__spreadArray(h.__spreadArray([],r&&r.normalizedPath?r.normalizedPath:[],!0),[e.name],!1)).filter(Boolean)},y.generatePath=function(e,r){return(r&&r.hierarchy===e.hierarchy?h.__spreadArray(h.__spreadArray([],(r.path||[]).slice(0,-1),!0),[(0===e.levelNum?e.hierarchy:e.name)||null],!1):h.__spreadArray(h.__spreadArray([],r&&r.path?r.path:[],!0),[0===e.levelNum?e.hierarchy:e.name],!1)).filter(Boolean)},y.toMatrix=function(r,n,a,e,t,o,i,u){void 0===n&&(n=-1),void 0===a&&(a=0),void 0===e&&(e=void 0),void 0===t&&(t=void 0),void 0===o&&(o=void 0),void 0===i&&(i=void 0),void 0===u&&(u=void 0);var s=(0,y.getMaxNesting)(r),l=(0,y.getMaxExpansion)(r),c=e||s,f=t||l,p=o?o.slice():[],d=i?i.slice():new Array(f),e=p.findIndex(function(e){return e&&e.name===r.levelName&&e.level===r.levelNum}),t=p[e],o={name:r.levelName,level:r.levelNum,index:n,cells:new Array(f).fill(null)},i=-1!==n&&-1!==a,m={caption:r.caption,name:r.name,levelName:r.levelName,levelNum:r.levelNum,hasChildren:r.hasChildren,parentName:r.parentName,hierarchy:r.hierarchy,total:void 0!==r.total&&r.total||u&&u.children.length<=1&&u.total,parent:u,rowIndex:n,colIndex:a,depth:1,breadth:1,path:r.path||[],normalizedPath:r.normalizedPath||[],children:r.children.filter(function(e){return e.hierarchy===r.hierarchy})};if(i)if(t)t.cells[a]=m,t.index>=n&&(n=t.index);else{if(p[n]&&p[n].cells.length){for(var g=n;g<p.length;g++)p[g].index++;p.splice(n,0,o)}else p[n]=o;p[n].cells[a]=m}var h=0;return r.children&&r.children.length?r.children.forEach(function(e){var e=(0,y.toMatrix)(e,n+1,a+h,c,f,p,d,m),r=e[0],t=e[1];h+=e[3]||1,p=r.slice(),d=t.slice()}):r.normalizedPath&&(d[a]={total:m.total,path:r.normalizedPath}),m.depth=s,[p,d,s,m.breadth=l]};function t(e,r){for(var t in e){var n;e.hasOwnProperty(t)&&(n=e[t],r[t]=a(n,r[t]))}}function a(e,r){return Array.isArray(e)?n(e):e instanceof Date?(0,y.cloneDate)(e):e&&"object"==typeof e?(t(e,r=r||{}),r):e}function l(e){return JSON.parse(JSON.stringify(e))}function n(e){return e.map(function(e){return a(e,void 0)})}y.toTree=function(e){var n={children:[]},a={};if(e.every(function(e){return 1===e.members.length&&u(e.members[0])}))return{children:e.map(function(e){e=e.members[0];return h.__assign(h.__assign({},e),{normalizedPath:[e.name],parentName:e.name,path:[e.hierarchy]})})};for(var r=0;r<e.length;r++)for(var o=l(e[r]),i="",t=0;t<o.members.length;t++)(e=>{var r,t=o.members[e];n.children&&0===n.children.length?r=n:a[i]&&!a[i+t.name]&&0===t.levelNum?r=a[i]:a[i+t.parentName]&&0<t.levelNum&&!a[i+t.parentName+t.name]?r=a[i+t.parentName]:!a[i+t.parentName]&&0<t.levelNum&&!a[i+t.parentName+t.name]&&(e=Object.keys(a).find(function(e){return t.parentName===a[e].name}))&&(r=a[e]),r&&(t.path=(0,y.generatePath)(t,r),t.normalizedPath=(0,y.generateNormalizedPath)(t,r),-1!==(e=r.children.findIndex(function(e){return e.hierarchy!==r.hierarchy}))?r.children.splice(e,0,t):r.children.push(t)),t.parentName+=t.name,a[i+=t.parentName]||(a[i]=t)})(t);return l(s(n))},y.toData=function(e,r,n,t,a){function o(e){return e.join("|")}function i(e){return e.members.map(function(e){return e.name})}var u=Array.from(new Array(a),function(){return{cells:Array.from(new Array(t),function(){return null})}}),s=new Map,l=new Map;return r.forEach(function(e,r){s.set(o(e.path),r)}),n.forEach(function(e,r){l.set(o(e.path),r)}),e.forEach(function(e){var r=s.get(o(i(e.columnTuple))),t=l.get(o(i(e.rowTuple)));void 0===r||void 0===t||u[t].cells[r]||(u[t].row=n[t].path,u[t].cells[r]=e)}),u},y.toColumns=function(e){for(var r,e=(0,y.toMatrix)(e),t=e[0],n=e[1],a=e[2],o=e[3],i=0;i<o;i++)for(var u=null,s=0;s<a;s++)t[s]&&(!(r=t[s].cells[i])&&u&&(u.rowSpan=(u.rowSpan||1)+1),u&&(u.colSpan=u.breadth||1),r)&&(u=r);return[t,n,a,o]},y.toRows=function(e){for(var r,e=(0,y.toMatrix)(e),t=e[0],n=e[1],a=e[2],o=e[3],i=0;i<o;i++)for(var u=null,s=0;s<a;s++)t[s]&&(!(r=t[s].cells[i])&&u&&(u.rowSpan=(u.rowSpan||1)+1),u&&(u.colSpan=u.breadth),r)&&(u=r);for(var l,c=t,e=n,f=a,p=o,d=new Array(p),m=0;m<p;m++)for(var g=0;g<f;g++)c[g]&&c[g].cells[m]&&(l=c[g].cells[m],d[m]||(d[m]={cells:new Array(f).fill(null)}),d[m].cells[g]=h.__assign(h.__assign({},l),{rowSpan:l.colSpan,colSpan:l.rowSpan}));return[d,e,p,f]},y.cloneDate=function(e){return e?new Date(e.getTime()):null};var o=function(e,r,t){return{hierarchyUniqueName:e,uniqueName:r,caption:r,measure:r,name:r,type:t,kpi:!0}};y.addKPI=function(e){for(var r,t=0;t<e.length;t++)if(2===e[t].type){r=!0;break}r&&e.splice(t+1,0,{caption:"KPIs",defaultHierarchy:"[KPIs]",name:"KPIs",uniqueName:"[KPIs]"})},y.compareAxisWithField=function(e,r){return String(e.name)===String([r.defaultHierarchy||r.uniqueName])},y.compareAxes=function(e,r){return String(e.name)===String(r.name)},y.filterField=function(n,a){for(var e=n.length-1;0<=e;e--)(e=>{var r=n[e],t=r.name.findIndex(function(e){return(0,y.compareAxisWithField)({name:[e]},a)||String(e).startsWith(a.uniqueName)});-1!==t&&(t===r.name.length-1||1===r.name.length?n.splice(e,1):(r.name.splice(t,1),-1!==(t=n.findIndex(function(e){return e!==r&&String(e.name)===String(r.name)}))&&(n[t]=h.__assign(h.__assign(h.__assign({},n[t]),r),n[t].expand||r.expand?{expand:!0}:{}),n.splice(e,1))))})(e)},y.insertAxis=function(e,r,t){var n,a=-1;t.dropTarget&&t.dropDirection&&(n=!t.dropDirection||"before"===t.dropDirection?0:1,a=e.findIndex(function(e){return(0,y.compareAxes)(e,t.dropTarget)})+n),-1!==a?(e.forEach(function(e){e.expand&&1<e.name.length&&e.name.length>a&&(e=e.name).splice.apply(e,h.__spreadArray([a,0],r.name,!1))}),e.splice(a,0,r)):e.push(r)},y.reverseColumnsByMeasures=function(e){var r=e.length&&e[0],r=r&&r.members[r.members.length-1];if(r&&u(r)){for(var t=[],n=new Set(e.map(function(e){return e.members[e.members.length-1].caption})).size,a=0;a<e.length;a+=n)t.push(e.slice(a,a+n));var o=[];return t.forEach(function(e){o.push.apply(o,e.reverse())}),o}return e}},48:e=>{e.exports=t},109:e=>{e.exports=o}},a={},function e(r){var t=a[r];return void 0!==t||(t=a[r]={exports:{}},n[r](t,t.exports,e)),t.exports}(875)))}}});